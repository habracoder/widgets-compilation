/*marketgid.comV3*/MarketGidBaseBlockC605 = function(root_id, BH, fallback, containerId, uniqId, versionWidget) { var self = this; this.BH = BH; this.root = this.BH.document.getElementById(root_id); this.containerId = containerId; this.uniqId = uniqId; this.RT = fallback; this.page = 1; this.iteration = 1; this.adlink = ''; this.template = ''; this.id = 605; this.originalId = 605; this.tickerShow = 0; this.pvid = 0; this.VX = []; this.muid = ""; this.EX = {}; this.RS = {}; this.ME = []; this.HL = []; this.WL = []; this.KK = ""; this.GD = ""; this.HZ = 0; this.PY = {}; this.FJ = ""; this.KJ = ""; this.banners = {}; this.crashStep = 0; this.loadedDefault = false; this.teaserHashes = {}; this.IN = {}; this.json = []; this.servicerData = {}; this.childWidgetsData = []; this.versionWidget = versionWidget; this.sspPerformance = '10' >= Math.ceil(Math.random() * 100); this.fakeMode = 0; this.requestParams = {}; self.webProtocol = 'https:'; if (self.BH.self !== self.BH.top) { refererUrl = self.BH.document.referrer; var parts = refererUrl.split('/'); self.intExchangeProtocol = parts[0].indexOf('http') == 0 ? parts[0] : 'https:'; } else { var protocol = self.BH.document.location.protocol; self.intExchangeProtocol = protocol.indexOf('http') == 0 ? protocol : 'https:'; } self.sourceName = ""; this.templates = []; this.templateId = 0; self.setStyles = function(styles) { self.styles = styles.replace(/\((\'|\")?\/\//g, '($1' + self.webProtocol + '//'); }; self.setTemplate = function(template) { template = template.replace(/^\s*[\r\n]|\s{2,}/gm, ''); template = template.replace(/\((\'|\")?\/\//g, '($1' + self.webProtocol + '//'); template = template.replace('src="//', 'src="' + self.webProtocol + '//'); self.templateText = template.replace('href="//', 'href="' + self.webProtocol + '//'); }; this.TO = "servicer.marketgid.com"; self.setTemplate('<table class="mctable" > <tr> {foreach}<td valign="top" class="mcteaser" style="width:33.33%; height:100%;"> <table cellpadding="0" cellspacing="1" style="width:100%; height:100%;"> <tr><td style="height:100%;width:90px" valign="top" class="mccc"><div class="mcimage"><a {$target} {$href} ><img class="mcimage" {$src} /></a></div></td><td style="height:100%;" valign="top" class="mcrc"><div class="mctitle"><a {$target} {$href} class="mctitle">{$title}</a></div><div class="mcdesc"><a {$target} {$href} class="mcdesc">{$desc}</a></div></td></tr></table></td>{if $iteration%3 == 0 && $iteration!=3}</tr><tr>{/if} {/foreach} </tr> </table>'); self.setStyles('.mctable, .mctable * {margin:0; padding:0; border:0; font-style:normal; font-size:100.01%; line-height:1; text-decoration:none; color:#000; line-height:1.1em;} .mctable cite{color:red;} .mctable{border-spacing:2px; margin:auto !important; font:11px Tahoma, Verdana, Arial;} .mctable{ font-family: Tahoma,Geneva,sans-serif; width: 728px; border-width: 1px; border-style: solid; border-color: #e6e6fa; } .mctable *{ letter-spacing: 0em; } .mctitle{ font-weight: bold; font-size: 11px; text-decoration: underline; color: #4169e1; } .mctitle *{ color: #4169e1 !important; } div.mcimage{ text-align: center; } .mcdesc{ font-size: 11px; color: #000000; } .mcdesc *{ color: #000000 !important; } .mcsource{ color: #000000; font-size: 11px; } .mcsource *{ color: #000000 !important; } .mcteaser{ padding: 0px; } .mccc{ padding: 0px; } .mcrc{ padding: 0px; } .mctc{ padding: 0px; background-color: #e6e6fa; } .mcbc{ padding: 0px; } '); self.adBlockStyles = ''; self.adBlockStyles = self.adBlockStyles.replace(/\((\'|\")?\/\//g, '($1' + self.webProtocol + '//'); self.clickTracking = ""; self.OG = ''; self.funcBlocks = {}; self.IN = {}; self.loadedPopularTeaser = false; self.deviceType = "desktop"; self.hrefAttr = "href"; self.IS = []; self.consentData = ''; self.cmpEnabled = false; self.cookieMatchingDomain = 'cm.marketgid.com' ; self.BH._mgIntExchangeNews = self.BH._mgIntExchangeNews || {}; this.XR = function(str,limit,dots) { if (str.length<=limit) return str; var word=new Array(); word=str.split(" "); var ret=word[0] + ' '; var test; for (i=1;i<word.length;i++){ test=ret+word[i]; if (test.length>limit) return ret + (typeof(dots) == 'undefined' || dots ? '...' : ''); else ret+=word[i] + ' '; } return str; }; this.BF = function(str,limit){ var word=new Array(); var i; var ret=''; word=str.split(" "); for (i=0;i<word.length;i++){ if (word[i].length>limit && word[i].search(/&\w+;/)<0) ret+=word[i].substr(0,limit) + ' ' + word[i].substr(limit) + ' '; else ret+=word[i] + ' '; } return ret; }; this.OA = function(title) { title=this.BF(title,15); title=this.XR(title,60,1); return title; }; this.KD = function(desc) { desc=this.BF(desc,15); desc=this.XR(desc,60); return desc; }; this.isArray = function(o) { return Object.prototype.toString.call(o) === '[object Array]'; }; self.fixGetElementsByClassNameHandler = function(el) { if (el.getElementsByClassName == undefined) { el.getElementsByClassName = function(cl) { var retnode = []; var myclass = new RegExp('\\b'+cl+'\\b'); var elem = this.getElementsByTagName('*'); for (var i = 0; i < elem.length; i++) { var classes = elem[i].className; if (myclass.test(classes)) retnode.push(elem[i]); } return retnode; }; } }; this.ND = function() { if (!self.RT) { if (self.BH.document.getElementById("MarketGidPreloadC" + this.containerId)) { self.BH.document.getElementById("MarketGidPreloadC" + this.containerId).style.display = 'none'; } else if (self.BH.document.getElementById("M180PreloadC" + this.containerId)) { self.BH.document.getElementById("M180PreloadC" + this.containerId).style.display = 'none'; } } else if (self.RT && this.HZ == 0) { self.root.innerHTML = ""; if (self.BH.document.getElementById("M180PreloadC605")) { self.BH.document.getElementById("M180PreloadC605").style.display = 'none'; } } }; this.MarketGidLoadNews = function(json, servicerData) { this.ND(); if (typeof servicerData != 'undefined') { self.servicerData = servicerData; if (typeof servicerData.dt != 'undefined') { self.deviceType = servicerData.dt; } if (self.servicerData.hasOwnProperty('templateId') && self.templates[self.servicerData.templateId]) { var templateScript = this.BH.document.createElement('script'); templateScript.type = 'text/javascript'; templateScript.charset = 'windows-1251'; templateScript.src = self.webProtocol + '//' + self.templates[self.servicerData.templateId]; var getTemplate = function() { var i, templates = self.BH._mgtemplates; for (i in templates) { if ((templates[i].widgetId == self.id || templates[i].widgetId == self.originalId) && templates[i].templateId == self.servicerData.templateId) { return templates[i]; } } return null; }; this.root.parentNode.appendChild(templateScript); var attempts = 5; var interval = setInterval(function() { var template = getTemplate(); if (null === template) { if (--attempts >= 0) { return; } else { (new Image(0, 0)).src = self.webProtocol + '//c.marketgid.com/widget-template-timeout?id=' + self.id; } } else { self.templateId = template.templateId; self.setStyles(template.styles); self.setTemplate(template.template); } clearInterval(interval); self.MarketGidLoadNews(json); }, self.servicerData.tsi || 15); return; } } if (self.fakeMode == 0) { for (var i = 0; i < self.ME.length; i++) { self[self.ME[i]](); } } if (this.isArray(json)){ var template = self["templateFunc"](self, json); self.json = json; if (this.root && template) { if (typeof self.parseAdvertLink == 'function') { template = self.parseAdvertLink(template); } if (this.RT && this.HZ == 0) { this.root.innerHTML = "" } this.addTemplate(template); this.renderBanners(); } } else { if (this.root && this.HZ==0) { this.root.innerHTML=''; return; } } if (self.servicerData && self.servicerData.muidn && self.servicerData.pvid && self.pvid != 0 && self.servicerData.pvid == self.pvid) { try { if (self.BH.localStorage) { self.BH.localStorage.setItem('mgMuidn', self.servicerData.muidn); } } catch (e) {} } this.EX["page"] = this.page; this.EX['time'] = (new Date()).getTime(); this.setCookie(); var hrefs = this.root.getElementsByTagName("a"); for (var i = 0; i < hrefs.length; i++) { hrefs[i].rel = "nofollow noopener"; } if (typeof self.templateId !== "undefined" && self.templateId !== 0) { self.EM(self.styles, self.BH.document.getElementsByClassName('MarketGidC605')[0]); } this.HZ++; if (self.fakeMode == 0) { for (var i = 0; i < self.HL.length; i++) { self[self.HL[i]](); } } else { if (typeof(self.responsiveInit) == "function") { self.responsiveInit(); } } }; this.addTemplate = function(template) { this.root.insertAdjacentHTML('beforeend', this.FJ + template + this.KJ); }; this.IG = function() { var d = this.BH.document, w = this.BH, dE = 'documentElement', cH = 'clientHeight', cW = 'clientWidth', iH = 'innerHeight', iW = 'innerWidth', sH = 'scrollHeight', sW = 'scrollWidth', oH = 'offsetHeight', oW = 'offsetWidth', oL = 'offsetLeft', oT = 'offsetTop', sT = 'scrollTop', sL = 'scrollLeft'; if (w[iW]) { return {"c": w[iH], "s": w.pageYOffset}; } else if (d[dE] && d[dE][cW]) { return {"c": d[dE][cH], "s": d[dE][sT]}; } else if (d.body[cW]) { return {"c": d.body[cH], "s": d.body[sT]}; } return 0; }; this.renderItem = function(n, callbackText, type) { if ('html' in n) { var bid = 'mgBanner_605_' + this.page + '_' + this.iteration; var styles = 'width: 100%; height: 100%; border: 0px; margin: 0px; overflow: hidden; position: relative;'; var banner = '<iframe id="' + bid + '" scrolling="no" style="' + styles + '"></iframe>'; this.banners[bid] = n; n = ['', this.iteration]; } else { var banner = ''; } if (self.isArray(n)) { var p = self.RK(n, type); if (p.id && (!(p.id in self.PY) || (typeof self.isElastic !== 'undefined' && self.isElastic == true))) { if (typeof p.hash !== 'undefined' && typeof p.id !== 'undefined') { self.teaserHashes[p.id] = p.hash; } self.PY[p.id] = 1; var addClasses = []; if (!self.loadedPopularTeaser && typeof(p.other.adc) != 'undefined' && ( p.other.adc.toString().indexOf('mrsadca') >= 0 || p.other.adc.toString().indexOf('mrsadcp') >= 0 )) { addClasses.push('mgpopular'); self.loadedPopularTeaser = true; } addClasses.push('teaser-' + p.id); if ('l' in p.other && null != p.other.l.match(/[\?|&]u=/)) { addClasses.push('dsp'); } if ('type' in p.other) { addClasses.push('type-' + p.other.type); } var createWebLink = function(url) { return url && url.indexOf('//') === 0 ? self.webProtocol + url : url; }; var price = p.price.replace(new RegExp('[^0-9.]'), ''); var priceOld = p.priceold.replace(new RegExp('[^0-9.]'), ''); var vars = [ [/\{\*.*?\*\}/, ''], [/\{\$href\}/g, self.hrefAttr + '="' + self.GN(p.hash) + '" data-hash="' + p.hash + '"'], [/\{\$pmc_item\}/, self.id], [/\{\$hash\}/g, p.hash], [/\{\$target\}/g, ((typeof p.other.type !== 'undefined' && p.other.type == 'i') || (typeof self.servicerData.ats !== 'undefined' && self.servicerData.ats)) ? 'target="_top"' : 'target="_blank"'], [/(class\=\"[^+]?)(mgline)([^+]?\")/, '$1$2 ' + addClasses.join(' ') + '$3'], [/\{\$source\}/g, p.source], [/\{\$src\}/g, 'width="90" height="90"' + ' data-i="'+p.id+'" src="'+ createWebLink(p.other["i"]) + '"'], [/\{\$title\}/g, self.OA(p.title)], [/\{\$desc\}/g, self.KD(p.desc)], [/\{\$iteration\}/g, self.iteration], [/\$iteration/g, self.iteration], [/this\.iteration/g, self.iteration], [/\{\$price\}/g, p.price], [/\{\$priceold\}/g, p.priceold], [/\{\$discount\}/g, p.discount], [/\{if \$price\}/g, "{if '' != " + price + "}"], [/\{if !\$price\}/g, "{if '' == " + price + "}"], [/\{if \$priceold\}/g, "{if '' != " + priceOld + "}"], [/\{if \$price != " "\}/g, "{if " + p.price.trim().length + " != 0}"], [/\{if \$price == " "\}/g, "{if " + p.price.trim().length + " == 0}"], [/\$priceold/g, p.priceold], [/\$price/g, p.price], [/\{if \$rep\}/g, "{if p.isReplic}"], [/\{\$banner\}/g, banner], [/\{if \$teaser\}/g, "{if '' == '" + banner + "'}"], [/\{if \$banner\}/g, "{if '' != '" + banner + "'}"], [/\{\$category\}/g, p.other.category || ''], [/\{\$sourceName\}/g, self.sourceName] ]; for (var i = 0 ; i < vars.length; i++) { callbackText = callbackText.replace(vars[i][0], vars[i][1]); } while (true) { var x = callbackText; var r = /\{if ([^\}]*?)\}(((?!\{(?:\/)?if).)*)\{\/if\}/g; callbackText = callbackText.replace(r, function(str, p1, p2) { if (self.expressionParser(p1)) { return p2; } else { return ''; } }); if (x == callbackText) break; } this.iteration++; return callbackText; } else { self.PY[p.id]++; return ""; } } }; this.renderBanners = function() { for (var i in self.banners) { var iframe = self.BH.document.getElementById(i); iframe.contentWindow.document.open(); iframe.contentWindow.document.write("<html><body>" + self.banners[i].html + "</body></html>"); iframe.contentWindow.document.close(); iframe.contentWindow.document.body.addEventListener('click', function(event) { var node = event.target; var isLink = false; while (node.parentElement) { if (node.tagName === 'A') { isLink = true; break; } else { node = node.parentElement; } } if (isLink) { var image = new Image(); image.src = self.banners[i].clickUrl + self.getAntifraudQueryParameter(self.banners[i].clickUrl); } }, true); } }; this.expressionMap = { '||': function(parts) { for (var i in parts) { if (self.expressionParser(parts[i])) { return true; } } return false; }, '&&': function(parts) { for (var i in parts) { if (!self.expressionParser(parts[i])) { return false; } } return true; }, '==': function(parts) { return self.expressionParser(parts[0]) == self.expressionParser(parts[1]); }, '!=': function(parts) { return self.expressionParser(parts[0]) != self.expressionParser(parts[1]); }, '+': function(parts) { return self.expressionParser(parts[0]) + self.expressionParser(parts[1]); }, '-': function(parts) { return self.expressionParser(parts[0]) - self.expressionParser(parts[1]); }, '*': function(parts) { return self.expressionParser(parts[0]) * self.expressionParser(parts[1]); }, '/': function(parts) { return self.expressionParser(parts[0]) / self.expressionParser(parts[1]); }, '%': function(parts) { return self.expressionParser(parts[0]) % self.expressionParser(parts[1]); } }; this.expressionParser = function(expression) { for (var i in self.expressionMap) { if (expression.indexOf(i) !== -1) { return self.expressionMap[i](expression.split(i)); } } return (expression || '').replace(/^([\'|\s]+)|([\'|\s]+)$/g, ''); }; this.generateTemplate = function(templateText) { self["templateText"] = templateText; self["templateFunc"] = function(inf, json) { var parts = /(.*)?\{foreach\}(.*)?\{\/foreach\}(.*)?/.exec(self["templateText"]); if (!parts) { return; } var template = typeof(parts[1]) != 'undefined' ? parts[1] : ''; for (var i = 0; i < json.length; i++) { template += inf.renderItem(json[i], parts[2], 'goods'); } template += typeof(parts[3]) != 'undefined' ? parts[3] : ''; return template; }; return true; }; this.getPageCount = function () { var pagesCountNews = parseInt(''); var pagesCountGoods = parseInt('20'); return pagesCountNews && pagesCountGoods ? Math.min(pagesCountNews, pagesCountGoods) : (pagesCountNews ? pagesCountNews : pagesCountGoods); }; this.init = function() { if (typeof JSON !== 'object') { this.ND(); console.log('Unsupported browser'); } if (this.root) { this.getCookie(); var cookiePage = parseInt(this.EX["page"]); this.VX = this.root.getElementsByTagName('a'); var pageOffset = (this.BH['MarketGidPageOffset'] ? parseInt(this.BH['MarketGidPageOffset']) : 0); self.addEvent(self.root, 'click', self.hangNiceLinkListener); self.addEvent(self.root, "\x63\x6f\x6e\x74\x65\x78\x74menu", self.hangNiceLinkListener); self.addEvent(self.root, 'mouseup', self.hangNiceLinkListener); self.addEvent(self.root, 'touchstart', self.hangNiceLinkListener); var pagesCount = self.getPageCount(); if (cookiePage != null && cookiePage < pagesCount && cookiePage > 0 ) { this.page = cookiePage + 1; } else if (cookiePage > (pagesCount - 1) || cookiePage < 1 ) { this.page = 1 + pageOffset; } if ((new Date()).getTime() - (this.EX['time']!=undefined ? this.EX['time'] : 0) >= 6e5) { this.page = 1+pageOffset; } if (!this.page) this.page = 1; this.pageUnlim = this.page - 1; this.EX["page"] = this.page; this.setCookie(); if (!this.BH.document.cookie) { var dt = new Date(); this.page = dt.getSeconds()%pagesCount+1; } this.KK = self.webProtocol + '//'+this.TO+'/'; self.clickTracking = typeof(self.BH.MGClickTracking) != 'undefined' ? self.BH.MGClickTracking : ""; if (!self.generateTemplate(self.templateText)) { return; } self.BH.onClickExcludes = self.BH.onClickExcludes || []; self.BH.onClickExcludes.push(self.root); if (typeof self.adBlockStatement !== "undefined" && self.adBlockStatement == 1 && '' !== "headline-in-picture") { self.EM(self.adBlockStyles); } else { self.EM(self.styles); } for (var i=0; i<this.WL.length; i++) { this[this.WL[i]](); } } }; this.resetPage = function() { this.page = 1; }; this.getMostTopWindow = function() { var w = self.BH; while (w != w.parent) { try { var test = w.parent.document.body; w = w.parent; } catch (e) { break; } } return w; }; this.getCbusterParameter = function() { return 'cbuster=' + (this.BH.MG_CacheBuster || ((new Date().getTime()) + '' + Math.floor((Math.random() * 1000000000) + 1))); }; this.YT = function(forceShow, refresh) { if ((typeof self.widgetPreload != "undefined" && self.widgetPreload) || typeof self.updatePrecalcRect == "undefined") { self.injectionScriptMethod(forceShow, refresh); } else { self.updatePrecalcRect(self.injectionScriptMethod) } }; this.injectionScriptMethod = function (forceShow, refresh) { var isOnlyOwnSubnet = parseInt('0'); var isPopunder = parseInt('0'); var isYandex = self.BH.navigator.userAgent.indexOf('YaBrowser') >= 0; var isMarketgid = self.TO.indexOf('marketgid.com') >= 0; if (isMarketgid && isYandex && !isOnlyOwnSubnet && !isPopunder) { self.KK = self.webProtocol + '//'+self.LFServicers[2]+'/'; } self.adBlockStatement = false; if (self.adBlockStatement) { self.requestParams.limitads = "limitads=" + '3'; } var script = self.BH.document.createElement('script'); script.type = 'text/javascript'; script.charset = 'windows-1251'; var scriptSrc = ""; var fs = forceShow ? 'fs/' : ''; scriptSrc += self.KK + fs + '605/' + self.page; if (refresh) { self.requestParams.rsh = "rsh=" + refresh; } if (typeof self.BH.MGi != "undefined") { self.requestParams.geo = "geo_zone=" + self.BH.MGi; } self.requestParams.pv = "pv=5"; self.requestParams.cbuster = self.getCbusterParameter(); if (JSON.parse('[]').indexOf('int_exchange') >= 0 || 0 ) { var ogUrlEl = self.BH.document.querySelector('meta[property="og:url"]'); var ogTitleEl = self.BH.document.querySelector('meta[property="og:title"]'); if (self.BH !== self.BH.top) { ogUrlEl = self.BH.document.referrer.split('?')[0]; } if (ogUrlEl) { self.requestParams.ogurl = 'ogurl=' + encodeURIComponent(typeof ogUrlEl === "object" ? ogUrlEl.getAttribute('content') : ogUrlEl); } if (ogTitleEl) { self.requestParams.ogtitle = 'ogtitle=' + encodeURIComponent(ogTitleEl.getAttribute('content')); } } if (self.uniqId != '') { self.requestParams.uniqId = "uniqId=" + self.uniqId; } if (self.getActiveChilds().length) { self.requestParams.childs = "childs=" + self.getActiveChilds().join(","); } if (typeof self.BH.MG_setRequestNonPersonalizedAds != 'undefined' && self.BH.MG_setRequestNonPersonalizedAds == 1) { self.requestParams.npa = "npa=1"; } if ('0' == '1' && self.getInternalIds().length != 0) { self.requestParams.viewedInternalIds = "exclude_int_exchange=" + self.getInternalIds().join(','); } if (self.cmpEnabled) { var consentData = { "consentData": "", "gdprApplies": false }; if (self.consentData != '' && typeof self.consentData.gdprApplies !== 'undefined' && typeof self.consentData.consentData !== 'undefined') { consentData = self.consentData; } else { if (self.BH.localStorage) { try { var data = JSON.parse(self.BH.localStorage.getItem('MG_ConsentData')); if (data != null && typeof data.gdprApplies !== 'undefined' && typeof data.consentData !== 'undefined') { consentData = data; } } catch (err) {} } } self.requestParams.consentData = "consentData=" + consentData.consentData; self.requestParams.gdprApplies = "gdprApplies=" + consentData.gdprApplies; } if (scriptSrc.indexOf('?') == -1) { scriptSrc += '?'; } else { scriptSrc += '&'; } var params = []; for (var key in self.requestParams) { params.push(self.requestParams[key]); } var isIframe = self.BH.self !== self.BH.top; try { self.BH.top.body; var isCrossIframe = true; } catch (e) { var isCrossIframe = false; } params.push('ref=' + encodeURIComponent(isIframe && isCrossIframe ? self.BH.parent.document.referrer : self.BH.document.referrer)); if (isIframe) { params.push('iframe=1'); } try { if (!sessionStorage.MG_Session_lastUpdate || Number(sessionStorage.MG_Session_lastUpdate) + 30 * 60 * 1000 < Date.now()) { var refererUrl = isIframe ? self.BH.parent.document.referrer : self.BH.document.referrer; var matchDomain = refererUrl.match(/:\/\/([^\/:]+)/i); sessionStorage.MG_Session_pr = matchDomain && matchDomain[1] ? matchDomain[1] : ''; sessionStorage.MG_Session_lu = isIframe ? self.BH.parent.location.href : self.BH.location.href; } sessionStorage.MG_Session_lastUpdate = Date.now(); if (sessionStorage && sessionStorage.MG_Session_pr) { params.push('pr=' + encodeURIComponent(sessionStorage.MG_Session_pr)) } if (sessionStorage && sessionStorage.MG_Session_lu) { params.push('lu=' + encodeURIComponent(sessionStorage.MG_Session_lu)) } } catch(err) { } var w = self.getMostTopWindow(); if (typeof w._mgPageView180 == 'undefined') { w._mgPageView180 = true; params.push('pageView=1'); } else { params.push('pageView=0'); } self.pvid = (new Date()).getTime().toString(16) + (Math.round(Math.random() * 1000000000)+2147483648).toString(16); params.push('pvid=' + self.pvid); if (self.versionWidget != '') { params.push('implVersion=' + self.versionWidget); } try { if (self.BH.localStorage) { var mgMuidn = self.BH.localStorage.getItem('mgMuidn'); if (mgMuidn) { params.push('muid=' + mgMuidn); self.muid = mgMuidn; } } } catch (ex) {} scriptSrc += params.join("&"); script.src = scriptSrc; if (self.sspPerformance) { script.onload = function() { self.BH.performance.getEntries().map(function(entry) { if (entry.name === scriptSrc) { var duration = Math.ceil(entry.responseEnd - entry.startTime); (new Image(0, 0)).src = self.webProtocol + '//c.marketgid.com/widget-ssp-performance?time=' + duration; } }); }; } (self.realRoot != undefined ? self.realRoot : self.root).parentNode.appendChild(script); script.onerror = function () { self.isAdblock = true; }; }; this.getActiveChilds = function() { return []; }; this.start = function() { if (self.root && self.HZ == 0) { if ("function" == typeof self.BH.__cmp) { self.cmpEnabled = true; try { self.BH.__cmp("getConsentData", null, function (result) { self.consentData = result; if (self.BH.localStorage) { self.BH.localStorage.setItem('MG_ConsentData', JSON.stringify(result)); } }); setTimeout(function() { self.YT(); }, 50); } catch (e) { self.YT(); } } else { self.YT(); } } }; this.addEvent = function(elem, type, handler) { if (elem.addEventListener) { elem.addEventListener(type, handler, false) } else { elem.attachEvent('on' + type, handler) } }; this.removeEvent = function(elem, type, handler) { if (elem.removeEventListener) { elem.removeEventListener(type, handler, false) } else { elem.detachEvent('on' + type, handler) } }; this.getMainCssSelector = function() { return "#" + (this.realRoot ? this.realRoot.id : this.root.id); }; this.doubleClickHandler = function(parameters) { var i, query = [], image = new Image(0, 0); if (parameters.url.tagName != 'A') { parameters.url = self.GO(parameters.url); if (null == parameters.url) { return; } } for (i in parameters) { query.push(encodeURIComponent(i) + '=' + encodeURIComponent(parameters[i])); } image.src = self.webProtocol + '//c.marketgid.com/doubleclick?' + query.join('&'); }; this.adBlockDetect = function () { var states = {ABP_NOT_DETECTED: 0, ABP_DETECTED: 1}; var classList = ["banner_ad", "sponsored_ad"]; var createBlockDetectionDiv = function (className) { var trigger = self.BH.document.createElement("div"); trigger.className = className; trigger.innerHTML = '.'; self.root.appendChild(trigger); return trigger; }; var isBlockDetectedOnDiv = function (e) { return !e.offsetHeight; }; var isBlockDetectedOnClassNames = function (e) { var i, r = e.length, o; for (i = 0; i < r; i++) { o = createBlockDetectionDiv(e[i]); var blockDetect = isBlockDetectedOnDiv(o); self.root.removeChild(o); if (blockDetect) { return true; } } return false; }; var getBlockedState = function (e) { return isBlockDetectedOnClassNames(e) ? states.ABP_DETECTED : states.ABP_NOT_DETECTED; }; return getBlockedState(classList); };};var mgCanLoad605 = false;var mgFallback605 = false;var mgShortWidget605 = false;if (document.getElementById("MG_ID")) { var rootId605 = document.getElementById("MG_ID").innerHTML; var mgRootId605 = parent.window.document.getElementById("MarketGidScriptRootC" + rootId605) ? ("MarketGidScriptRootC" + rootId605) : ("M180ScriptRootC" + rootId605); if (parent.window.document.getElementById(mgRootId605)) { mgCanLoad605 = true; }} else { var mgRootId605 = document.getElementById("MarketGidScriptRootC" + 605) ? ("MarketGidScriptRootC" + 605) : ("M180ScriptRootC" + 605); if (document.getElementById(mgRootId605)) { mgCanLoad605 = true; mgFallback605 = true; mgShortWidget605 = true; }} if (document.getElementById("MarketGidComposite605") || document.getElementById("M180Composite605")) { mgCanLoad605 = true; mgFallback605 = true; }if (this['mgCanLoad605']) { if (!mgFallback605) { var uniqId = ""; if ('0' == '1') { uniqId = ("00000" + Math.round(Math.random()*100000).toString(16)).slice(-5); } var uniqStr = uniqId != "" ? ("_" + uniqId) : ""; var rootId605 = document.getElementById("MG_ID").innerHTML; var div605 = parent.window.document.createElement('div'); div605.id = "MarketGidComposite605" + uniqStr; var mgRootId605 = parent.window.document.getElementById("MarketGidScriptRootC" + rootId605) ? ("MarketGidScriptRootC" + rootId605) : ("M180ScriptRootC" + rootId605); var versionWidget = parent.window.document.getElementById("MarketGidScriptRootC" + rootId605) ? '9' : '10'; parent.window.document.getElementById(mgRootId605).id = mgRootId605 + uniqStr; var mgPreloadId605 = parent.window.document.getElementById("MarketGidPreloadC" + rootId605) ? ("MarketGidPreloadC" + rootId605) : ("M180PreloadC" + rootId605); if (parent.window.document.getElementById(mgPreloadId605)) { parent.window.document.getElementById(mgPreloadId605).id = mgPreloadId605 + uniqStr; } mgRootId605 = mgRootId605 + uniqStr; parent.window.document.getElementById(mgRootId605).appendChild(div605); MarketGidInfC605 = new MarketGidBaseBlockC605(div605.id, parent.window, false, rootId605 + uniqStr, uniqId, versionWidget); } else if (mgShortWidget605) { var uniqId = ""; if ('0' == '1') { uniqId = ("00000" + Math.round(Math.random()*100000).toString(16)).slice(-5); } var uniqStr = uniqId != "" ? ("_" + uniqId) : ""; if (!window.document.getElementById("MarketGidComposite605") || !window.document.getElementById("M180Composite605") ) { var div605 = window.document.createElement('div'); div605.id = "MarketGidComposite605" + uniqStr; var rootDiv605 = window.document.getElementById("MarketGidScriptRootC" + 605) ? ("MarketGidScriptRootC" + 605) : ("M180ScriptRootC" + 605); window.document.getElementById(rootDiv605).appendChild(div605); window.document.getElementById(rootDiv605).id = rootDiv605 + uniqStr; } var mgPreloadId605 = window.document.getElementById("MarketGidPreloadC" + 605) ? ("MarketGidPreloadC" + 605) : ("M180PreloadC" + 605); if (window.document.getElementById(mgPreloadId605)) { window.document.getElementById(mgPreloadId605).id = mgPreloadId605 + uniqStr; } var mgRootId605 = document.getElementById("MarketGidComposite605" + uniqStr) ? "MarketGidComposite605" + uniqStr : "M180Composite605" + uniqStr; MarketGidInfC605 = new MarketGidBaseBlockC605(mgRootId605, window, false, 605 + uniqStr, uniqId, 11); } else { var mgRootId605 = document.getElementById("MarketGidComposite605") ? "MarketGidComposite605" : "M180Composite605"; var versionWidget = document.getElementById("MarketGidComposite605") ? '3' : '4'; document.getElementById(mgRootId605).innerHTML = ""; MarketGidInfC605 = new MarketGidBaseBlockC605(mgRootId605, window, false, 0, '', versionWidget); } this['MarketGidCMainBlock605'] = function(self){ self.addEvent(self.root, 'mousemove' ,function (e) { self.root.mouseX = e.pageX - self.root.offsetLeft; self.root.mouseY = e.pageY - self.root.offsetTop; }); self.BI = function(hash, event, element) { var href = ""; var data = self.IN[hash]; if (element && typeof self.BH._mgExternalLinkChanger !== 'undefined' && self.BH._mgExternalLinkChanger == 1) { href = element.protocol + "//" + element.hostname + element.pathname; var paramsStr = element.search; if (paramsStr != '') { paramsStr = paramsStr.replace("?", ""); var params = paramsStr.split("&"); for (var i = 0; i < params.length; i++) { var param = params[i].split("="); if (param[0] != 'k' && param[0] != 'dc') { href += (i == 0 ? "?" : "&") + params[i]; } } } } else { href = self.clickTracking + self.webProtocol; if (data) { if (data.link) { if (/^http[s]?:/.test(data.link)) { href = self.clickTracking + data.link; } else if (data['coopType'] == 'i') { href = self.clickTracking + self.intExchangeProtocol + data.link; } else { href = self.clickTracking + self.webProtocol + data.link; } } } else { href = "#"; } } var dcparam = ""; if (typeof self.YU !== 'undefined' && self.YU) { if (typeof self.isWagesLink === 'function' && self.isWagesLink(element)) { dcparam = 'dc=1'; } } var delayClickParam = self.getQueryParameterByName('dc'); if (delayClickParam) { dcparam = 'dc=' + parseInt(delayClickParam); } var clickZone = self.getClickZone(); if (clickZone !== '' && dcparam == "") { dcparam = 'dc=' + self.getClickZone(); } if (dcparam !== "") { href += ((href.indexOf('?') >= 0) ? '&' : '?') + dcparam; } if (typeof self.GA == 'function' && data && data['coopType'] != 'i') { href += self.getAntifraudQueryParameter(href, event, element); } if (self.clickTracking && href.indexOf(self.clickTracking) !== -1) { href = self.clickTracking + encodeURIComponent(href.replace(self.clickTracking, '')); } if (self.templateId) { href += ((href.indexOf('?') >= 0) ? '&' : '?') + 'tpl=' + self.templateId; } try { if (self.BH.localStorage) { var mgMuidn = self.BH.localStorage.getItem('mgMuidn'); if (typeof (mgMuidn) == "string" && mgMuidn.length > 0 ) { href += ((href.indexOf('?') >= 0) ? '&' : '?') + 'muid=' + mgMuidn; } } } catch (e) {}; if (true == parseInt('0')) { var template = ''; template = template.replace(/^(\/\/)/, self.BH.location.protocol + '$1'); template = template.replace(/(%host%)/, self.BH.location.host); template = template.replace(/(%title%)/, self.SI(data[3])); href = template.replace(/(%rurl%)/, self.NR(href, true)); } return href; }; self.getClickZone = function() { var coordinate = JSON.parse('[]'); if (coordinate.length == 0) { return ''; } if (typeof coordinate.top == "undefined" || typeof coordinate.left == "undefined" || typeof coordinate.right == "undefined" || typeof coordinate.bottom == "undefined" ) { return ''; } var height = self.root.offsetHeight; var width = self.root.offsetWidth; var pixelCoordinate = []; pixelCoordinate['top'] = parseInt(height / 100 * coordinate.top); pixelCoordinate['left'] = parseInt(width / 100 * coordinate.left); pixelCoordinate['right'] = width - parseInt(width / 100 * coordinate.right); pixelCoordinate['bottom'] = height - parseInt(height / 100 * coordinate.bottom); var mouseX = self.root.mouseX; var mouseY = self.root.mouseY; var zoneIds = [ [2, 3, 4], [5, '', 6], [7, 8, 9], ]; return zoneIds[ (mouseY <= pixelCoordinate['top']) ? 0 : (mouseY >= pixelCoordinate['bottom'] ? 2 : 1) ][ (mouseX <= pixelCoordinate['left']) ? 0 : (mouseX >= pixelCoordinate['right'] ? 2 : 1) ]; }; self.getAntifraudQueryParameter = function(href, event, element) { var params = self.GA(event, element); if (params) { var suffix = self.id; return ((href.indexOf('?') >= 0) ? '&' : '?') + 'k=' + suffix + 'f' + params; } return ''; }; self.GN = function(hash, event, element) { var href; var data = self.IN[hash]; if (data.other['sdl'] == 1 && data['coopType'] != 'i') { href = self.clickTracking; if (typeof(data.other['dl']) != 'undefined' && data.other['dl'] != '') { href += data.other['dl']; } else { var source = decodeURIComponent(data[0].replace(/[`|',:\/?;$%&\(\)^*!@\s]/g, '')).toLowerCase(); var title = decodeURIComponent(data[3].replace(/[`|',:\/?;$%&\(\)^*!@]/g, '')).replace(/\s/g, '_'); href += self.webProtocol + '//' + (source ? source + '/' : '') + title; } if (self.clickTracking && href.indexOf(self.clickTracking) !== -1) { href = self.clickTracking + encodeURIComponent(href.replace(self.clickTracking, '')); } } else { href = self.BI(hash, event, element); } return href; }; self.SI = function(str) { var a = { 'Ё':'YO','Й':'I','Ц':'TS','У':'U','К':'K','Е':'E','Н':'N','Г':'G','Ш':'SH','Щ':'SCH', 'З':'Z','Х':'H','Ъ':'','ё':'yo','й':'i','ц':'ts','у':'u','к':'k','е':'e','н':'n', 'г':'g','ш':'sh','щ':'sch','з':'z','х':'h','ъ':'\'','Ф':'F','Ы':'I','В':'V','А':'a', 'П':'P','Р':'R','О':'O','Л':'L','Д':'D','Ж':'ZH','Э':'E','ф':'f','ы':'i','в':'v','а':'a', 'п':'p','р':'r','о':'o','л':'l','д':'d','ж':'zh','э':'e','Я':'Ya','Ч':'CH','С':'S', 'М':'M','И':'I','Т':'T','Ь':'','Б':'B','Ю':'YU','я':'ya','ч':'ch','с':'s','м':'m', 'и':'i','т':'t','ь':'','б':'b','ю':'yu',' ':'_', 'і':'i', 'І':'I', 'ї':'i', 'Ї':'I' }; return str.split('').map(function (char) { if (char.match(/[a-z0-9_\-]/i)) { return char; } return a[char] || ''; }).join(''); }; self.getQueryParameterByName = function(name) { name = name.replace(/[\[\]]/g, "\\$&"); var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"); var results = regex.exec(self.BH.location.href); if (!results) { return null; } if (!results[2]) { return ''; } return decodeURIComponent(results[2].replace(/\+/g, " ")); }; self.GO = function(el) { while (el && el.tagName !== 'BODY') { if (el.tagName == "A") { return el; } else { el = el.parentNode; } } return null; }; self.KI = function (element, selector) { var foundElements; while (element.parentNode) { foundElements = element.parentNode.querySelectorAll(selector); for (var i = 0; i < foundElements.length; i++) { if (element.isEqualNode(foundElements[i])) { return foundElements[i]; } } element = element.parentNode; } return null; }; self.RK = function(data, type) { var t = {}; t.source = data[0]; t.id = data[1]; t.title = (typeof data[3] != 'undefined') ? data[3] : ""; t.desc = (typeof data[4] != 'undefined') ? data[4] : ""; if (type.toLowerCase() == 'news') { t.mirror = data[5] ? data[5] : self.LFs[self.YJ]; t.hash = data[6]; t.other = data[7]; t.price = " "; t.priceold = t.discount = ""; t.isReplic = false; } else { t.mirror = self.LFs[self.YJ]; t.key = data[6]; t.price = (typeof data[7] != 'undefined') ? data[7].replace(".00", "") : ""; t.priceold = (typeof data[8] != 'undefined') ? data[8].replace(".00", "") : ""; t.discount = t.priceold.replace(new RegExp('[^0-9.]'), '') == '' ? '' : Math.floor((1 - t.price.replace(/[^\d,]+/g, '').replace(',', '.') / t.priceold.replace(/[^\d,]+/g, '').replace(',', '.')) * 100) + '%'; t.hash = data[9]; t.other = (typeof data[10] != 'undefined') ? data[10] : {}; var titleLower = t.title.toLowerCase(); var descLower = t.desc.toLowerCase(); var replicWords = ["копия", "подделка", "реплика", "как оригинал"]; var replicInsertWords = ["Копия. ", "Реплика. "]; if (data[5] == '1') { t.isReplic = true; for (var i = 0; i < replicWords.length; i++) { if (self.OA(titleLower).indexOf(replicWords[i]) > -1 || self.KD(descLower).indexOf(replicWords[i]) > -1) { t.isReplic = false; break; } } } else { t.isReplic = false; } } if (self.deviceType != 'desktop') { t.other.sdl = 0; } data['other'] = t.other; self.IN[t.hash] = data; self.IN[t.hash]['id'] = t.id; self.IN[t.hash]['img'] = typeof(t.other['i']) != 'undefined' ? t.other['i'] : null; self.IN[t.hash]['source'] = t.source; self.IN[t.hash]['img'] = t.other["i"]; self.IN[t.hash]['type'] = type; self.IN[t.hash]['link'] = typeof(t.other['l']) != 'undefined' ? t.other['l'] : null; self.IN[t.hash]['mirror'] = t.mirror; self.IN[t.hash]['coopType'] = typeof(t.other['type']) != 'undefined' ? t.other['type'] : null; self.IN[t.hash]['clicktrackers'] = typeof(t.other['clicktrackers']) != 'undefined' ? t.other['clicktrackers'] : []; self.IN[t.hash]['cdomain'] = t.other.cdomain || null; self.IN[t.hash]['ccid'] = t.other.ccid || null; self.IN[t.hash]['ch'] = t.other.ch || null; self.IN[t.hash]['imp'] = typeof(t.other['imp']) != 'undefined' ? t.other['imp'] : []; if (self.IN[t.hash]['coopType'] == 'i') { self.BH._mgIntExchangeNews[t.id] = 1; } return t; }; self.getInternalIds = function() { return Object.keys(self.BH._mgIntExchangeNews); }; self.NR = function(s, replaceChars) { replaceChars = typeof replaceChars == 'undefined' ? replaceChars : false; var b64c = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='; var b64e = ''; var c1, c2, c3, e1, e2, e3, e4; var i = 0; while (i < s.length) { c1 = s.charCodeAt(i++); c2 = s.charCodeAt(i++); c3 = s.charCodeAt(i++); e1 = c1 >> 2; e2 = ((c1&3) << 4) | (c2 >> 4); e3 = isNaN(c2) ? 64 : (((c2&15) << 2) | (c3 >> 6)); e4 = isNaN(c3) ? 64 : (c3&63); b64e += b64c.charAt(e1) + b64c.charAt(e2) + b64c.charAt(e3) + b64c.charAt(e4); } if (true == replaceChars) { b64e = b64e.replace('+', '-').replace('/', '_').replace('=', '*'); } return b64e; }; self.hangNiceLinkListener = function(event) { if (self.loadedDefault) { return; } if (!event) { var event = self.BH.event; } if (!event.target) { event.target = event.srcElement; } var element = event.target; if (element.tagName != 'A') { var element = self.GO(element); if (null == element) { return; } } var hash = element['data-hash'] || element.getAttribute('data-hash'); if (hash != undefined) { if (typeof self.IN[hash] != 'undefined' && typeof self.IN[hash]['other'] != 'undefined' && typeof self.IN[hash]['other']['sdl'] != 'undefined' ) { self.IN[hash]['other']['sdl'] = 0; } element[self.hrefAttr] = self.BI(hash, event, element); } }; self.htmlToElement = function (html) { var template = document.createElement('div'); template.innerHTML = html; return template.firstChild; }; self.htmlToElements = function (html) { var template = self.BH.document.createElement('div'); template.innerHTML = html; return Array.prototype.slice.call(template.childNodes); }; self.PA = function (el) { while (el.tagName !== 'BODY') { if ('fixed' != el.style.position && null == el.offsetParent) { return true; } if ('hidden' == el.style.visibility) { return true; } if ('none' == el.style.display) { return true; } el = el.parentNode; } return false; }; self.EM = function(style, container) { style = style.replace(/(@media \([^(]*\) {)/g, "$1}"); style = style.replace(/((?:^|}|,)\W*)((?:\w+)?\.(?:mc|mg)[\-\w]+)/g, "$1" + this.getMainCssSelector() + " $2"); style = style.replace(/((@media \([^(]*\) \{)\})/g, "$2"); style = style.replace(/video-cdn\.(.+)\/mgPlayer/g, self.YJDomain); if (style == "") return; if (!container) { var MGst = self.BH.document.createElement('style'); MGst.className = 'MarketGidC605'; MGst.type = 'text/css'; (self.realRoot != undefined ? self.realRoot : self.root).appendChild(MGst); if (MGst.styleSheet) { MGst.styleSheet.cssText = style; } else { MGst.appendChild(self.BH.document.createTextNode(style)); } ; } else { var MGst = container; MGst.className = 'MarketGidC605'; if (MGst.styleSheet) { MGst.styleSheet.cssText = style; } else { while (MGst.firstChild) { MGst.removeChild(MGst.firstChild); } MGst.appendChild(self.BH.document.createTextNode(style)); } ; } };}; this['MarketGidCMainBlock605'].call(this['MarketGidInfC605'], this['MarketGidInfC605']); this['MarketGidInfC605']['funcBlocks']['Main'] = 'MarketGidCMainBlock605'; MarketGidCCookieBlock605 = function(self){ this.storageName = "MarketGidStorage" + (this.BH.MarketGidPageOffset ? this.BH.MarketGidPageOffset : ""); this.NY = function() { var matches = this.BH.document.cookie.match(new RegExp("(?:^|; )" + this.storageName + "=([^;]*)")); var res = {}; if (matches) { try { res = JSON.parse(decodeURIComponent(matches[1])); } catch (e) {}; } return res; }; this.getCookie = function() { var value = this.NY(); if (value["C605"]!=undefined) { this.EX = value["C605"]; } else this.EX = {}; if (value["0"]!=undefined) { this.RS = value["0"]; } else this.RS = {}; }; this.setCookie = function() { var totalCookie = this.NY(); totalCookie["C605"] = this.EX; totalCookie["0"] = this.RS; var value = encodeURIComponent(JSON.stringify(totalCookie)); this.BH.document.cookie = this.storageName+"="+value+";path=/"; };}; this['MarketGidCCookieBlock605'].call(this['MarketGidInfC605'], this['MarketGidInfC605']); this['MarketGidInfC605']['funcBlocks']['Cookie'] = 'MarketGidCCookieBlock605'; MarketGidCSubnetsBlock605 = function() { var self = this; self.funcBlocks["Subnets"] = "MarketGidCSubnetsBlock605"; this.WL.push("LS"); this.YJ = ""; this.LFs = {}; this.LFServicers = {}; this.LFsImages = {}; this.LFsAdvert = {}; this.LFsAdLinkBlocks = {}; this.LFsUtm = {}; this.subnetDashboardDomains = {}; this.LFNames = {}; this.LFs['0'] = 'marketgid.com'; this.LFServicers['0'] = 'servicer.marketgid.com'; this.LFNames['marketgid'] = parseInt('0'); this.LFsImages['0'] = 'marketgid.com'; this.LFsAdLinkBlocks['0'] = '<div class="mgheader"><span class="mghead">%WIDGET_TITLE%</span><div class="mg_addad%id widgets_logo%id"><a href="http://usr.marketgid.com/demo/celevie-posetiteli%utm%id" target="_blank"></a></div></div><style>.mghead{font-weight:700;font-size:14px;text-transform:uppercase;text-align:left;font-family: "Open Sans", sans-serif;color:#4555a7;display:block;margin:0 0 0px 5px;float:left;}.mgheader{min-height:12px; cursor: default; display: table !Important; width: 100% !important;}.widgets_logo%id{position:relative}.widgets_logo%id a{background:url(//cdn.marketgid.com/images/widgets_marketgid.png) no-repeat;width:88px;height:15px;position:absolute;display:block;bottom:-15px;right:7px}.mgbox{margin-bottom:15px!important;}.widgets_logo%id:hover a{background:url(//cdn.marketgid.com/images/widgets_marketgid_hover.png) no-repeat}</style>'; this.LFsUtm['0'] = '?utm_source=informer&utm_medium=text&utm_campaign=add&utm_content='; this.subnetDashboardDomains['0'] = self.webProtocol + '//dashboard.marketgid.com'; this.LFs['1'] = 'ladycenter.ru'; this.LFServicers['1'] = 'servicer.marketgid.com'; this.LFNames['lady'] = parseInt('1'); this.LFsImages['1'] = 'marketgid.com'; this.LFsAdLinkBlocks['1'] = '<div class="mg_addad%id"><a href="http://ladycenter.ru/celevie-posetiteli.html%utm%id" class="mg_addad%id" target="_blank"><img src="//img.marketgid.com/images/search/2/icon-2.png"> Добавить объявление</a></div><style type="text/css">div.mg_addad%id{text-align: center;} div.mg_addad%id a{font:normal 11px Tahoma, Arial, sans-serif; color:#009966; text-decoration: none;} div.mg_addad%id img{margin-bottom: -1px;}</style>'; this.LFsUtm['1'] = '?utm_source=informer&utm_medium=text&utm_campaign=add&utm_content='; this.subnetDashboardDomains['1'] = self.webProtocol + '//dashboard.marketgid.com'; this.LFs['2'] = 'tovarro.com'; this.LFServicers['2'] = 'servicer.tovarro.com'; this.LFNames['tovarro'] = parseInt('2'); this.LFsImages['2'] = 'tovarro.com'; this.LFsAdLinkBlocks['2'] = '<div class="mgheader"><span class="mghead">%WIDGET_TITLE%</span><div class="mg_addad%id widgets_logo"><a href="http://tovarro.com/%utm%id" target="_blank"></a></div></div><style>.widgets_logo{position:relative}.widgets_logo a {background:url(//cdn.tovarro.com/images/tovarro/add-advert.png) no-repeat right top;width: 48px;height: 20px;position:absolute;display: block;bottom: -15px;right: 4px;opacity: 0.7;}.widgets_logo a:hover {opacity: 1;background:url(//cdn.tovarro.com/images/tovarro/add-advert.png) no-repeat right top;}.mgheader {display: block !Important;width: 100% !important;}.mgbox{ margin-bottom:20px!important;}</style>'; this.LFsUtm['2'] = '?utm_source=informer&utm_medium=text&utm_campaign=add&utm_content='; this.subnetDashboardDomains['2'] = self.webProtocol + '//dashboard.tovarro.com'; this.LFs['3'] = 'lentainform.com'; this.LFServicers['3'] = 'servicer.lentainform.com'; this.LFNames['lentainform'] = parseInt('3'); this.LFsImages['3'] = 'lentainform.com'; this.LFsAdLinkBlocks['3'] = '<div class="mgheader"><span class="mghead">%WIDGET_TITLE%</span><div class="mg_addad%id widgets_logo"><a href="http://partner.lentainform.com" target="_blank"></a></div></div><style>.widgets_logo{position:relative}.widgets_logo a{background:url(https://cdn.marketgid.com/images/lentainform/widgets_lentainform.png) no-repeat;width:88px;height:10px;position:absolute;display:block;bottom:-10px;right:7px}.mgbox{margin-bottom:15px!important;}.widgets_logo:hover a{background:url(https://cdn.marketgid.com/images/lentainform/widgets_lentainform_hover.png) no-repeat}</style>'; this.LFsUtm['3'] = '?utm_source=informer&utm_medium=text&utm_campaign=add&utm_content='; this.subnetDashboardDomains['3'] = self.webProtocol + '//dashboard.lentainform.com'; this.LFs['4'] = 'marketgid.com'; this.LFServicers['4'] = 'servicer.marketgid.com'; this.LFNames['marketgid'] = parseInt('4'); this.LFsImages['4'] = 'marketgid.com'; this.LFsAdLinkBlocks['4'] = '<div class="mgheader"><span class="mghead">%WIDGET_TITLE%</span><div class="mg_addad%id widgets_logo%id"><a href="http://usr.marketgid.com/demo/celevie-posetiteli%utm%id" target="_blank"></a></div></div><style>.mghead{font-weight:700;font-size:14px;text-transform:uppercase;text-align:left;font-family: "Open Sans", sans-serif;color:#4555a7;display:block;margin:0 0 0px 5px;float:left;}.mgheader{min-height:12px; cursor: default; display: table !Important; width: 100% !important;}.widgets_logo%id{position:relative}.widgets_logo%id a{background:url(//cdn.marketgid.com/images/widgets_marketgid.png) no-repeat;width:88px;height:15px;position:absolute;display:block;bottom:-15px;right:7px}.mgbox{margin-bottom:15px!important;}.widgets_logo%id:hover a{background:url(//cdn.marketgid.com/images/widgets_marketgid_hover.png) no-repeat}</style>'; this.LFsUtm['4'] = '?utm_source=informer&utm_medium=text&utm_campaign=add&utm_content='; this.subnetDashboardDomains['4'] = self.webProtocol + '//dashboard.marketgid.com'; this.WL.push("LS"); var informerData = []; informerData.push({"id": "605"}); this.LS = function() { for (var i = 0; i < informerData.length; i++) { var tickerId = informerData[i].id; if ('0' !== '1') { (function(tickerId) { self.BH["MarketGidLoadGoods" + tickerId + (self.uniqId != '' ? ('_' + self.uniqId) : '')] = function(json, awd) { self.originalId = self.id; self.id = tickerId; self.OG = 'goods'; self.YJ = '0'; self.YJDomain = 'marketgid.com'; self["MarketGidLoadNews"](json, awd); }; self.BH["MarketGidCReject" + tickerId] = self['MarketGidReject']; })(tickerId); } if ('1' !== '1') { (function(tickerId) { self.BH["MarketGidLoadGoods" + tickerId + (self.uniqId != '' ? ('_' + self.uniqId) : '')] = function(json, awd) { self.originalId = self.id; self.id = tickerId; self.OG = 'goods'; self.YJ = '1'; self.YJDomain = 'ladycenter.ru'; self["MarketGidLoadNews"](json, awd); }; self.BH["MarketGidCReject" + tickerId] = self['MarketGidReject']; })(tickerId); } if ('2' !== '1') { (function(tickerId) { self.BH["TovarroLoadGoods" + tickerId + (self.uniqId != '' ? ('_' + self.uniqId) : '')] = function(json, awd) { self.originalId = self.id; self.id = tickerId; self.OG = 'goods'; self.YJ = '2'; self.YJDomain = 'tovarro.com'; self["MarketGidLoadNews"](json, awd); }; self.BH["TovarroCReject" + tickerId] = self['MarketGidReject']; })(tickerId); } if ('3' !== '1') { (function(tickerId) { self.BH["LentaInformLoadGoods" + tickerId + (self.uniqId != '' ? ('_' + self.uniqId) : '')] = function(json, awd) { self.originalId = self.id; self.id = tickerId; self.OG = 'goods'; self.YJ = '3'; self.YJDomain = 'lentainform.com'; self["MarketGidLoadNews"](json, awd); }; self.BH["LentaInformCReject" + tickerId] = self['MarketGidReject']; })(tickerId); } if ('4' !== '1') { (function(tickerId) { self.BH["MarketGidLoadGoods" + tickerId + (self.uniqId != '' ? ('_' + self.uniqId) : '')] = function(json, awd) { self.originalId = self.id; self.id = tickerId; self.OG = 'goods'; self.YJ = '4'; self.YJDomain = 'marketgid.com'; self["MarketGidLoadNews"](json, awd); }; self.BH["MarketGidCReject" + tickerId] = self['MarketGidReject']; })(tickerId); } } }; self.getSubnetByMirror = function(mirror) { var subnet = 0; if (typeof self.LFNames[mirror] != 'undefined') { subnet = self.LFNames[mirror]; } return subnet; }}; this['MarketGidCSubnetsBlock605'].call(this['MarketGidInfC605'], this['MarketGidInfC605']); this['MarketGidInfC605']['funcBlocks']['Subnets'] = 'MarketGidCSubnetsBlock605'; MarketGidCInternalExchangeLoggerBlock605 = function(self){ self.HL.push("iExchangeLoggerInit"); self.iExchangeLoggerInit = function () { self.addEvent(self.root, "click", function(event) { if (!event) var event = self.BH.event; if (!event.target) { event.target = event.srcElement; } self.QY = true; var element = event.target; if (element.tagName != 'A') { var element = self.GO(element); if (null == element) { return; } } if (!element.hasAttribute('data-hash')) { return; } var hash = element.getAttribute('data-hash'); if (self.IN[hash] && self.IN[hash]['coopType'] == 'i') { var img = document.createElement('IMG'); var data = "cid=" + self.id + "&tid=" + self.IN[hash]['id'] + "&h=" + hash; if (typeof self.servicerData['isBot'] !== 'undefined') { data += "&bot=" + self.servicerData['isBot']; } if (typeof self.servicerData['tt'] !== 'undefined') { data += "&tt=" + self.servicerData['tt']; } if (typeof self.servicerData['ts'] !== 'undefined') { data += "&ts=" + self.servicerData['ts']; } var scriptSrc = "//c.marketgid.com/clie?" + data; img.src = self.webProtocol + scriptSrc; img.onerror = function () { }; } }); };}; this['MarketGidCInternalExchangeLoggerBlock605'].call(this['MarketGidInfC605'], this['MarketGidInfC605']); this['MarketGidInfC605']['funcBlocks']['InternalExchangeLogger'] = 'MarketGidCInternalExchangeLoggerBlock605'; MarketGidCInternalExchangeBlock605 = function(self){ self.HL.push("WB"); function ZO(BH) { var ZR = []; var XI = [BH]; while (XI.length > 0) { var el = XI.pop(); for (var i = 0; i < el.childNodes.length; i++) { var node = el.childNodes[i]; if (node.nodeType === Node.COMMENT_NODE) { ZR.push(node); } else { XI.push(node); } } } return ZR; } self.WB = function () { if (self.IS.indexOf('int_exchange') == -1) { return; } var comments = ZO(self.root); for (var i = 0; i < comments.length; i++) { var comment = comments[i]; var mgline = self.KI(comment, '.mgline'); if (!mgline) { continue; } if (mgline.className.indexOf('type-w') == -1) { continue; } var img = self.BH.document.createElement("IMG"); img.setAttribute('height', 20); if (comment.data == 'intExchangeWagesImagePlace') { img.className = 'mcimgad'; img.src = self.webProtocol + "//cdn.marketgid.com/images/marketgid/int_exchange_wages_ad.svg"; } var link = mgline.querySelector('a'); var hash = link['data-hash'] || link.getAttribute('data-hash'); if (hash && self.IN[hash] && !!self.IN[hash]['source']) { if (comment.data == 'intExhangeWagesSourcePlace') { img.className = 'mcimgsrc'; img.src = self.webProtocol + "//cdn.marketgid.com/images/marketgid/int_exchange_wages_src.svg"; } } if (!img.src) { continue; } comment.parentNode.replaceChild(img, comment); } } }; this['MarketGidCInternalExchangeBlock605'].call(this['MarketGidInfC605'], this['MarketGidInfC605']); this['MarketGidInfC605']['funcBlocks']['InternalExchange'] = 'MarketGidCInternalExchangeBlock605'; this['MarketGidCAntiAdblockBlock605'] = function(self) { self.isAdblock = false; self.isServerSide = typeof loadServerSideAds18742 == 'function'; self.WL.push('initServerSide'); self.HL.push("initAntiAdblock"); self.initServerSide = function (){ if (self.isServerSide && self.isAdblock){ self.BH._mgq = self.BH._mgq || []; loadServerSideAds18742(self.BH._mgq); } }; self.initAntiAdblock = function () { if (self.isAdblock){ var displayType = "block"; if (self.root.style.display != ""){ displayType = self.root.style.display; } self.root.style.setProperty("visibility", "visible", "important"); self.root.style.setProperty("display", displayType, "important"); self.appendVisibleRecursive(self.root); self.root.addEventListener("click", function (t) { t.preventDefault(); var e = t.target; var n = ''; if (e.tagName == 'A') { return self.BH.location = e.href; } else { while ("A" != e.tagName) { e = e.parentNode; if (e == self.root) { return false; } } n = e.href; } return self.BH.location = n; }); } }; self.appendVisibleRecursive = function (node) { for (var i = -1, l = node.childNodes.length; ++i < l;) { var el = node.childNodes[i]; var displayType = "block"; if (typeof el.style != 'object'){ continue; } if (el.style.display == 'none') { continue; } if (el.tagName=='STYLE' || el.tagName == 'SCRIPT'){ continue; } if (el.tagName=='TD'){ displayType = "table-cell"; } if (el.tagName=='TR'){ displayType = "table-row"; } if (el.className.length > 0 && el.className.split(' ').indexOf('mgbox') > -1){ displayType = "flex"; } if (el.className.length > 0 && el.className.split(' ').indexOf('mgline') > -1){ displayType = "inline-block"; } if (el.tagName == 'A' && el.parentNode.className.length > 0 && el.parentNode.className.split(' ').indexOf('submit') > -1){ if (parseInt('') == 1) { displayType = "inline-block"; } else { continue; } } if (el.className.length > 0 && el.className.split(' ').indexOf('fake') > -1){ continue; } el.style.setProperty("visibility", "visible", "important"); el.style.setProperty("display", displayType, "important"); if (el.childNodes.length > 0){ self.appendVisibleRecursive(el); } } };}; this['MarketGidCAntiAdblockBlock605'].call(this['MarketGidInfC605'], this['MarketGidInfC605']); this['MarketGidInfC605']['funcBlocks']['AntiAdblock'] = 'MarketGidCAntiAdblockBlock605'; MarketGidCUtilsBlock605 = function(self){ self.utils = {}; self.utils.getScroll = function() { var w = self.utils.getWindow(); return { top: w.document.body.scrollTop || w.document.documentElement.scrollTop || 0, left: w.document.body.scrollLeft || w.document.documentElement.scrollLeft || 0 } }; self.utils.getRect = function(element, withScroll) { var rect = element.getBoundingClientRect(); var toReturn = { top: rect.top, bottom: rect.bottom, left: rect.left, right: rect.right, height: (rect.height ? rect.height : rect.bottom - rect.top), width: (rect.width ? rect.width : rect.right - rect.left) }; if (self.BH.self !== self.BH.top) { var frame = self.utils.getFrame(); if (frame) { var iframeRect = frame.getBoundingClientRect(); toReturn.top += iframeRect.top; toReturn.bottom += iframeRect.top; toReturn.left += iframeRect.left; toReturn.right += iframeRect.left; } } if (withScroll) { var scroll = self.utils.getScroll(); toReturn.top += scroll.top; toReturn.bottom += scroll.top; toReturn.left += scroll.left; toReturn.right += scroll.left; } return toReturn; }; self.utils.getViewportSize = function() { var w = self.utils.getWindow(); return { width: (w.innerWidth || w.document.documentElement.clientWidth), height: (w.innerHeight || w.document.documentElement.clientHeight) }; }; var currentWindow = undefined; self.utils.getWindow = function() { if (currentWindow === undefined) { var w = self.BH; if (self.BH.parent != self.BH.self) { try { if (self.BH.top.document != undefined) { w = self.BH.top; } } catch (err) { } } currentWindow = w; } return currentWindow; }; var topFrame = undefined; self.utils.getFrame = function() { if (topFrame === undefined) { try { for (var w = self.BH, frame = w.frameElement; w.frameElement; w = w.parent) { frame = w.frameElement; } topFrame = frame; } catch(err) { topFrame = null; } } return topFrame; }}; this['MarketGidCUtilsBlock605'].call(this['MarketGidInfC605'], this['MarketGidInfC605']); this['MarketGidInfC605']['funcBlocks']['Utils'] = 'MarketGidCUtilsBlock605'; MarketGidCRtbBlock605 = function(self){ this.HL.push("cmPixelLoad"); this.cmPixelLoad = function(fpQuery) { if (!self.BH['i.js.loaded'] && self.cookieMatchingDomain) { self.BH['i.js.loaded'] = true; var script = MarketGidInfC605.BH.document.createElement('script'); script.charset = 'windows-1251'; var scriptSrc = self.webProtocol + '//' + self.cookieMatchingDomain + '/i.js?' + self.getCbusterParameter(); if (typeof(fpQuery) == 'string' && fpQuery != "") { scriptSrc += fpQuery; } script.src = scriptSrc; script.type = 'text/javascript'; script.async = true; script.onerror = function () { self.BH['i.js.loaded'] = false; }; var currentRoot = MarketGidInfC605.realRoot != undefined ? MarketGidInfC605.realRoot : MarketGidInfC605.root; currentRoot.parentNode.appendChild(script); } if (!self.BH['i-noref.js.loaded'] && self.cookieMatchingDomain) { self.BH['i-noref.js.loaded'] = true; var iframe = document.createElement('IFRAME'); iframe.src = 'about:blank'; iframe.frameBorder = 0; iframe.style.position = 'absolute'; iframe.style.top = '0px'; iframe.style.left = '-1px'; iframe.style.width = '0px'; iframe.style.height = '0px'; iframe.style.display = 'none'; iframe.onload = function () { var script = this.contentDocument.createElement('script'); script.charset = 'windows-1251'; var scriptSrc = self.webProtocol + '//' + self.cookieMatchingDomain + '/i-noref.js?' + self.getCbusterParameter(); script.src = scriptSrc; script.type = 'text/javascript'; script.async = true; script.onerror = function () { self.BH['i-noref.js.loaded'] = false; }; this.contentDocument.body.appendChild(script); }; document.body.appendChild(iframe); } };}; this['MarketGidCRtbBlock605'].call(this['MarketGidInfC605'], this['MarketGidInfC605']); this['MarketGidInfC605']['funcBlocks']['Rtb'] = 'MarketGidCRtbBlock605'; MarketGidCMgqBlock605 = function(self){ this.isLongCheck = false; this.WL.push("mgqInit"); this.mgqWorker = function() { var length = self.BH._mgq.length; var pool = self.BH._mgq.slice(0); var mgqRemovedCounter = 0; for (var i = 0; i < length; i++) { var el = pool[i]; if (typeof(self.BH[el[0]]) == 'function') { try { self.BH[el[0]].apply(self.BH, el.slice(1)); } catch (e) { } self.BH._mgq.splice(i - mgqRemovedCounter, 1); mgqRemovedCounter++; } } if (!self.BH._mgqi) { self.BH._mgqi = self.BH.setInterval(function() { self.mgqWorker(); }, 5); } if (!self.isLongCheck) { if ((new Date()).getTime() - self.BH._mgqt > 10000) { self.isLongCheck = true; self.BH.clearInterval(self.BH._mgqi); self.BH._mgqi = self.BH.setInterval(function() { self.mgqWorker(); }, 100); } } }; this.mgqInit = function() { self.BH._mgq = self.BH._mgq || []; if (typeof(self.BH._mgqp) == 'undefined') { self.BH._mgqp = self.mgqWorker; self.BH._mgqt = (new Date()).getTime(); self.mgqWorker(); } };}; this['MarketGidCMgqBlock605'].call(this['MarketGidInfC605'], this['MarketGidInfC605']); this['MarketGidInfC605']['funcBlocks']['Mgq'] = 'MarketGidCMgqBlock605'; MarketGidCMobileDoubleClickBlock605 = function(self){ var isTouch = (('ontouchstart' in window) || (navigator.msMaxTouchPoints > 0)); if (isTouch){ this.HL.push("doubleClickHook"); this.informerId = this.root.getAttribute('id'); this.EM( '.MarketGidDButton605{' + 'display: inline-block;' + 'width: 168px;' + 'height: 48px;' + 'background: -moz-linear-gradient(#7DC586, #5BA860);' + 'background: -o-linear-gradient(#7DC586, #5BA860);' + 'background: -webkit-linear-gradient(#7DC586, #5BA860);' + 'background: linear-gradient(#7DC586, #5BA860);' + 'border: 1px solid #3C9342;' + 'color: #fff !important;' + 'font: normal 700 21px/48px "Zapf Dingbats", sans-serif;' + 'opacity: 0;' + 'left: -100%;' + 'text-align: center;' + 'text-shadow: none;' + 'position: absolute;' + 'text-decoration: none !important;' + 'transition:all 1s;'+ '}' + '.MarketGidDLayout605{' + 'height: 100%;' + 'width: 100%;' + 'position: absolute;' + 'top: 0px;' + 'left: 0px;' + 'background-color: rgba(0, 0, 0, 0.5);' + 'z-index: 99999;' + '}'+ '#MarketGidComposite605 .mgline {position:relative}' ); } this.doubleClickHook = function(){ self.doubleClickTimeLoaded = parseInt((new Date()).getTime()/1000); var informer = this.root; informer.addEventListener("click", this.showDoubleClickButton.bind(this), false); }; this.showDoubleClickButton = function(event) { self.YC = false; var clickedElement = event.target; self.doubleClickHandler({ url: clickedElement }); var currentTime = parseInt((new Date()).getTime()/1000); var doubleClickDeactivationDelay = 0; if (clickedElement.className != 'MarketGidDButton605' && (doubleClickDeactivationDelay === 0 || currentTime - self.doubleClickTimeLoaded < doubleClickDeactivationDelay)){ self.YC = true; event.preventDefault(); while (clickedElement.tagName != 'A' && clickedElement.id != this.informerId) { clickedElement = clickedElement.parentNode; if (clickedElement.id == this.informerId) { return; } } var href = clickedElement.getAttribute(self.hrefAttr); clickedElement = event.target; while (clickedElement.className.indexOf('mgline') == -1) { clickedElement = clickedElement.parentNode; } var teaserDiv = clickedElement; var layoutDiv = this.BH.document.createElement('div'); layoutDiv.className = 'MarketGidDLayout605'; var button = this.BH.document.createElement('a'); var buttonHeight = 50; var buttonWidth = 170; var top = (1-buttonHeight/teaserDiv.offsetHeight)/2*100; var scale = teaserDiv.offsetWidth/ buttonWidth*0.98; var symbol = navigator.userAgent.toLowerCase().match(/windows/) ? '&#187;' : '&#10093;'; var link = clickedElement.querySelector('a'); if (link && link.getAttribute('data-hash')) { button.setAttribute('data-hash', link.getAttribute('data-hash')); } button.innerHTML ='Перейти '+symbol; button.href = href; button.style.top = top+'%'; var left = scale > 1 ? (1-buttonWidth/teaserDiv.offsetWidth)/2*100 : 0; if (scale < 1){ button.style.transform = 'scale3d('+scale+','+scale+','+scale+')'; button.style.webkitTransform = 'scale3d('+scale+','+scale+','+scale+')'; button.style.transformOrigin = 'left'; button.style.webkitTransformOrigin = 'left'; } button.target = '_blank'; button.className = 'MarketGidDButton605'; layoutDiv.appendChild(button); teaserDiv.appendChild(layoutDiv); var buttonDelay = 0; setTimeout(function(){ button.style.left = left+'%';button.style.opacity = 1; }, buttonDelay); setTimeout(function(){layoutDiv.parentNode.removeChild(layoutDiv)}, 10000); } };}; this['MarketGidCMobileDoubleClickBlock605'].call(this['MarketGidInfC605'], this['MarketGidInfC605']); this['MarketGidInfC605']['funcBlocks']['MobileDoubleClick'] = 'MarketGidCMobileDoubleClickBlock605'; MarketGidCDesktopDoubleClickBlock605 = function(self){ var isTouch = (('ontouchstart' in window) || (navigator.msMaxTouchPoints > 0)); var isGoodBrowser = ('addEventListener' in window.document); if (!isTouch && isGoodBrowser){ this.HL.push("desktopDoubleClickHook"); this.informerId = this.root.getAttribute('id'); self.styles += '.MarketGidDButton605{' + 'display: inline-block;' + 'width: 168px;' + 'height: 33.33%;' + 'background: -moz-linear-gradient(#7DC586, #5BA860);' + 'background: -o-linear-gradient(#7DC586, #5BA860);' + 'background: -webkit-linear-gradient(#7DC586, #5BA860);' + 'background: linear-gradient(#7DC586, #5BA860);' + 'border: 1px solid #3C9342;' + 'color: #fff !important;' + 'font: normal 700 21px/48px "Zapf Dingbats", sans-serif;' + 'opacity: 0;' + 'left: -100%;' + 'text-align: center;' + 'text-shadow: none;' + 'position: absolute;' + 'text-decoration: none !important;' + 'transition:all 1s;'+ '}' + '.MarketGidDLayout605{' + 'height: 100%;' + 'width: 100%;' + 'position: absolute;' + 'top: 0px;' + 'left: 0px;' + 'background-color: rgba(0, 0, 0, 0.5);' + 'z-index: 100;' + '}'+ '#MarketGidComposite605 .mgline {position:relative}' + '.MarketGidDButton605:before{' + 'content: "";' + 'display: inline-block;' + 'vertical-align: middle;' + 'opacity: 0;' + 'visibility: hidden;' + 'height: 100%;' + 'width: 0;}' ; } this.desktopDoubleClickHook = function(){ self.doubleClickTimeLoaded = parseInt((new Date()).getTime()/1000); var informer = this.root; informer.addEventListener("click", this.showDesktopDoubleClickButton.bind(this), false); }; this.showDesktopDoubleClickButton = function(event) { self.YC = false; var clickedElement = event.target; var currentTime = parseInt((new Date()).getTime()/1000); var doubleClickDeactivationDelay = 0; self.doubleClickHandler({ url: clickedElement }); if (clickedElement.className != 'MarketGidDButton605' && (doubleClickDeactivationDelay === 0 || currentTime-self.doubleClickTimeLoaded < doubleClickDeactivationDelay)){ event.preventDefault(); self.YC = true; while (clickedElement.tagName != 'A' && clickedElement.id != this.informerId) { clickedElement = clickedElement.parentNode; if (clickedElement.id == this.informerId) { return; } } var href = clickedElement.getAttribute(self.hrefAttr); clickedElement = event.target; while (clickedElement.className.indexOf('mgline') == -1) { clickedElement = clickedElement.parentNode; } var teaserDiv = clickedElement, teaserHeight = teaserDiv.offsetHeight; var layoutDiv = this.BH.document.createElement('div'); layoutDiv.className = 'MarketGidDLayout605'; var button = this.BH.document.createElement('a'); var buttonHeight = teaserHeight/3 + 2; var buttonWidth = 170; var top = (1-buttonHeight/teaserDiv.offsetHeight)/2*100; (function getButtonPosition() { var clickY = event.clientY - teaserDiv.getBoundingClientRect().top; if (clickY < teaserHeight / 2) { return top = (1 - 2*buttonHeight/teaserHeight)*100/4 + 50; } return top = (1 - 2*buttonHeight/teaserHeight)*100/4; })(); var scale = teaserDiv.offsetWidth/ buttonWidth*0.98; var symbol = navigator.userAgent.toLowerCase().match(/windows/) ? '&#187;' : '&#10093;'; button.innerHTML ='Перейти '+symbol; button.href = href; var link = clickedElement.querySelector('a'); if (link && link.getAttribute('data-hash')) { button.setAttribute('data-hash', link.getAttribute('data-hash')); } button.style.top = top+'%'; var left = scale > 1 ? (1-buttonWidth/teaserDiv.offsetWidth)/2*100 : 0; if (scale < 1){ button.style.transform = 'scale3d('+scale+','+scale+','+scale+')'; button.style.webkitTransform = 'scale3d('+scale+','+scale+','+scale+')'; button.style.transformOrigin = 'left'; button.style.webkitTransformOrigin = 'left'; } button.target = '_blank'; button.className = 'MarketGidDButton605'; layoutDiv.appendChild(button); teaserDiv.appendChild(layoutDiv); setTimeout(function(){ button.style.left = left+'%';button.style.opacity = 1; }, 500); setTimeout(function(){layoutDiv.parentNode.removeChild(layoutDiv)}, 10000); } };}; this['MarketGidCDesktopDoubleClickBlock605'].call(this['MarketGidInfC605'], this['MarketGidInfC605']); this['MarketGidInfC605']['funcBlocks']['DesktopDoubleClick'] = 'MarketGidCDesktopDoubleClickBlock605'; this['MarketGidCAntifraudBlock605'] = function(self){ self.HL.push('GZ'); self.WL.push('WE'); self.IM = null; self.YD = null; self.QY = false; self.LC = ''; self.CD = ''; self.NM = ''; self.VL = ''; self.IH = ''; self.VS = ''; self.TH = ''; self.EP = ''; self.AB = ''; self.SS = 0; self.TE = 0; self.BO = ''; self.afCoords = ''; self.KX = ''; self.PW = ''; self.AO = ''; self.QK = 1; self.QKFlag = ''; self.afCharging = -1; self.afLevel = -1; self.topIFrame = undefined; self.WE = function() { if (typeof(self.RS['svspr']) === 'undefined') { self.NM = self.WX(self.BH.document.referrer, 500); self.RS['svspr'] = self.NM; self.setCookie(); } else { self.NM = self.RS['svspr']; } self.VL = self.BH.document.referrer; self.IH = self.BH.document.location.href; var r = []; r = self.QD(70, 50, 50); self.NM = self.NS(r[0]); self.VL = self.NS(r[1]); self.IH = self.NS(r[2]); if (typeof(self.RS['svsds']) !== 'undefined') { self.VS = self.RS['svsds']; self.VS++; } else { self.VS = 1; } self.RS['svsds'] = self.VS; self.setCookie(); var d = new Date(); self.LC = d.getTime() + '' + self.id + Math.floor(Math.random()*100) + '' + (2*Math.floor(Math.random()*4)); self.LC += 1; self.LC = self.XH(self.WX(self.LC, 16, 1)); self.SS = self.XH(d.getTime()); if (typeof(self.RS['TejndEEDj']) === 'undefined') { self.RS['TejndEEDj'] = self.LC; self.setCookie(); } self.BO = self.JC(); self.KX = self.SH(); self.QKFlag = self.getFocusFlag(); self.PW = self.NS(self.MC()); self.AO = self.XH(self.ZC()); self.generateBatteryInfo(); }; self.NS = function(s) { s = s.toString(); s = unescape(encodeURIComponent(s)); var b64c = '\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x24\x54\x55\x56\x57\x58\x59\x5a\x61\x62\x63\x64\x65\x2a\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x2b\x2f\x3d'; var b64e = ''; var c1, c2, c3, c4, e1, e2, e3, e4; for (var i = 0; i < s.length;) { c1 = s.charCodeAt(i++); c2 = 2 << 5; e1 = c1 >> (c2 / 32); c3 = s.charCodeAt(i++); e2 = ((c1 & 3) << (c2 / 16)) | (c3 >> (c2 / 16)); c4 = s.charCodeAt(i++); e3 = isNaN(c3) ? c2 : (((c3 & 15) << (c2 / 32)) | (c4 >> (c2 - 58))); e4 = isNaN(c4) ? c2 : (c4 & (c2 - 1)); b64e += b64c.charAt(e1) + b64c.charAt(e2) + b64c.charAt(e3) + b64c.charAt(e4); } return b64e; }; self.UL = function(n) { return n ? Math.round(n).toString(16) : ''; }; self.WX = function(str, n, r) { var length = str.length; if (length <= n) { return str; } var start = r ? length - n : 0; return str.substr(start, n); }; self.OB = function(element) { var offsetLeft = 0, offsetTop = 0; do { offsetLeft += element.offsetLeft; offsetTop += element.offsetTop; } while (element = element.offsetParent); return { 'x': offsetLeft, 'y': offsetTop }; }; self.QA = function(event) { var x = 0, y = 0; if (!event) event = self.BH.event; if (event.pageX || event.pageY) { x = event.pageX; y = event.pageY; } else if (event.touches && event.touches[0]) { x = event.touches[0].pageX; y = event.touches[0].pageY; } else if (event.clientX || event.clientY) { x = event.clientX + (self.BH.document.documentElement.scrollLeft || self.BH.document.body.scrollLeft) - self.BH.document.documentElement.clientLeft; y = event.clientY + (self.BH.document.documentElement.scrollTop || self.BH.document.body.scrollTop) - self.BH.document.documentElement.clientTop; } return { 'x':x, 'y':y }; }; self.TR = function(event) { var x = 0, y = 0; if (event.clientX || event.clientY) { x = event.clientX; y = event.clientY; } else if (event.touches && event.touches[0]) { x = event.touches[0].clientX; y = event.touches[0].clientY; } return { 'x':x, 'y':y }; }; self.getMaxTouchPoints = function() { var r = 98; if (typeof(self.BH.navigator.maxTouchPoints) !== 'undefined') { r = self.BH.navigator.maxTouchPoints; } else { r = 99; } return r; }; self.SH = function() { var XX = 0; if (self.BH.opera) { XX += 1; } if (self.BH.opera && self.BH.opera.buildNumber) { XX += 2; } if (self.BH.document.all || self.BH.MSStream) { XX += 4; } if (!self.BH.btoa || self.BH.navigator.msPointerEnabled || typeof(self.BH.clearImmediate) !== 'undefined') { XX += 8; } if (self.BH.chrome) { XX += 16; } if (typeof(self.BH.mozInnerScreenX) !== 'undefined') { XX += 32; } if (!self.BH.external) { XX += 64; } return XX; }; self.getFocusFlag = function() { var focusFlag = 0; if (self.BH.opera) { focusFlag += 1; } if (self.BH.opera && self.BH.opera.buildNumber) { focusFlag += 2; } if (self.BH.document.all || self.BH.MSStream) { focusFlag += 4; } if (!self.BH.btoa || self.BH.navigator.msPointerEnabled || typeof(self.BH.clearImmediate) !== 'undefined') { focusFlag += 8; } if (self.BH.chrome) { focusFlag += 16; } if (typeof(self.BH.mozInnerScreenX) !== 'undefined') { focusFlag += 32; } if (!self.BH.external) { focusFlag += 64; } return focusFlag; }; self.UY = function() { return self.BH.navigator.javaEnabled() ? 1 : 0; }; self.IJ = function() { var b = 0; if (typeof(self.BH.navigator.plugins) !== 'undefined' && typeof(self.BH.navigator.plugins["Shockwave Flash"]) == 'object') { b = 1; } else if (typeof(self.BH.ActiveXObject) !== 'undefined') { try { if (new ActiveXObject('ShockwaveFlash.ShockwaveFlash')) { b = 1; } } catch(e) {} } return b; }; self.WO = function() { return self.BH.navigator.cookieEnabled ? 1 : 0; }; self.HY = function() { if (self.BH.sessionStorage) { try { var e = null; self.BH.sessionStorage.setItem('svs', 1); e = self.BH.sessionStorage.getItem('svs'); } catch (n) {} } return e ? 1 : 0; }; self.QI = function() { if (self.BH.localStorage) { try { var e = null; self.BH.localStorage.setItem('svs', 1); e = self.BH.localStorage.getItem('svs'); } catch (n) {} } return e ? 1 : 0; }; self.FS = function() { var b = 0; if (self.UY()) b += 1; if (self.IJ()) b += 2; if (self.WO()) b += 4; if (self.QI()) b += 8; if (self.HY()) b += 16; if (self.isTouchStart()) b += 32; return b; }; self.isTouchStart = function() { return typeof(self.BH.ontouchstart) !== 'undefined'; }; self.JK = function(number) { return 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcde.ghijklmnopqrstuv0123456789wxyz-_'.substr(number, 1); }; self.IB = function(number) { var dict = { '00': 'A', '01': 'B', '02': 'C', '03': 'D', '04': 'E', '05': 'F', '06': 'G', '07': 'H', 10: 'I', 11: 'J', 12: 'K', 13: 'L', 14: 'M', 15: 'N', 16: 'O', 17: 'P', 20: 'Q', 21: 'R', 22: 'S', 23: 'T', 24: 'U', 25: 'V', 26: 'W', 27: 'X', 30: 'Y', 31: 'Z', 32: 'a', 33: 'b', 34: 'c', 35: 'd', 36: 'e', 37: '.', 40: 'g', 41: 'h', 42: 'i', 43: 'j', 44: 'k', 45: 'l', 46: 'm', 47: 'n', 50: 'o', 51: 'p', 52: 'q', 53: 'r', 54: 's', 55: 't', 56: 'u', 57: 'v', 60: '0', 61: '1', 62: '2', 63: '3', 64: '4', 65: '5', 66: '6', 67: '7', 70: '8', 71: '9', 72: 'w', 73: 'x', 74: 'y', 75: 'z', 76: '-', 77: '_', 0: '!', 1: '*', 2: ';', 3: ':', 4: '=', 5: '+', 6: '$', 7: '~' }; return dict[number]; }; self.QD = function(l1, l2, l3) { var arr = [self.NM, self.VL, self.IH]; var sizes = [l1, l2, l3]; var totalSize = 0; var totalLength = 0; for (var i = 0; i < sizes.length; i++) { totalSize += sizes[i]; totalLength += arr[i].length; } if (totalLength <= totalSize) return arr; var completes = [0, 0, 0]; var buffer = []; for (var i = 0; i < arr.length; i++) { var end = -1; if (arr[i].length >= 8) { end = arr[i].indexOf("/", 8); } if (end == -1) { buffer[i] = arr[i]; arr[i] = ''; } else { buffer[i] = arr[i].substr(0, end); arr[i] = arr[i].substr(end); } sizes[i] -= buffer[i].length; } var domains = buffer.slice(); var replaces = []; if (domains[0] == domains[1]) { replaces[0] = "++"; } else if (domains[0] == domains[2]) { replaces[0] = "::"; } if (domains[1] == domains[2]) { replaces[1] = ";;"; } while(1) { var bFlag = 0; for (var i = 0; i < arr.length; i++) { if (!completes[i] && !arr[i].length) { completes[i] = 1; for (var j = 0; j < completes.length; j++) { if (!completes[j]) { sizes[j] += sizes[i]; sizes[i] = 0; break; } } } else if (!completes[i]) { bFlag = 1; buffer[i] += arr[i][0]; if (arr[i].length != 1) { arr[i] = arr[i].substr(1); } else { arr[i] = ''; } sizes[i]--; if (!sizes[i]) { completes[i] = 1; } } } if (!bFlag) { for (var i = 0; i < arr.length; i++) { if (!arr[i].length) continue; for (var j = 0; j < sizes.length; j++) { if (sizes[j]) { completes[i] = 0; sizes[i] = sizes[j]; sizes[j] = 0; bFlag = 1; break; } } if (bFlag) { break; } } } if (!bFlag) { break; } } for (var i in replaces) { buffer[i] = buffer[i].split(domains[i]).join(replaces[i]); } return buffer; }; self.XH = function(number) { if (number == null) { return ''; } number = Math.abs(number); var oct = parseInt(number, 10).toString(8); var WK = 2; var n = Math.ceil(oct.length/WK); var chars = ''; for (var i = 0; i < n; i++) { var part = oct.substr(i*WK, WK); chars += self.IB(part); } return chars; }; self.JC = function() { var BE = {"props":{"3":"window.close","13":"window.navigator.taintEnabled","16":"window.EventTarget.toString","18":"window.navigator.appName","20":"window.ApplicationCacheErrorEvent","22":"window.clearImmediate","23":"window.CryptoKey","25":"window.external.AddSearchProvider","32":"window.chrome.search","33":"window.clientInformation.vendor","40":"window.TouchEvent","43":"window.DeviceMotionEvent","46":"window.navigator.webkitGetGamepads","49":"window.Notification","56":"window.BeforeLoadEvent","57":"window.Entity","72":"window.AnalyserNode","74":"window.ArrayBufferView","76":"window.HTMLBaseFontElement","86":"window.self.SharedWorker","87":"window.Touch","91":"window.DOMException.ABORT_ERR","92":"window.Set","98":"window.document.createTouch","138":"window.NaN","139":"window.document.prepend","163":"window.SiteBoundCredential","165":"window.CanvasCaptureMediaStreamTrack","166":"window.core.version","167":"window.Blob"},"rules":{"contains":{"3":["({command:\"window.close.self\"})"],"18":["MicrosoftInternetExplorer"],"33":["GoogleInc."]},"not_empty":[13,16,18,20,22,23,25,32,40,43,46,49,56,57,76,86,87,91,92,98,138,139,163,165,166],"undefined":[25,46,72,74,87,167]}}; var DO = ''; for (var i in BE['props']) { i = parseInt(i, 10); var node = window; var value = ''; var tree = BE['props'][i].split('.'); for (var depth in tree) { if (tree[depth] in node) { try { node = node[tree[depth]]; } catch (e) { node = 'undefined'; } } else { node = 'undefined'; break; } } value = (node + '').replace(/\s/g, ''); if (BE['rules']['contains'] && i in BE['rules']['contains']) { for (var j in BE['rules']['contains'][i]) { DO += value.indexOf(BE['rules']['contains'][i][j]) != -1 ? "1" : "0"; } } if (BE['rules']['empty'] && BE['rules']['empty'].indexOf(i) != -1) { DO += value == "" ? "1" : "0"; } if (BE['rules']['not_empty'] && BE['rules']['not_empty'].indexOf(i) != -1) { DO += (value != "undefined" && value != "") ? "1" : "0"; } if (BE['rules']['undefined'] && BE['rules']['undefined'].indexOf(i) != -1) { DO += value == "undefined" ? "1" : "0"; } } var WK = 6; var n = Math.ceil(DO.length/WK); var chars = ''; for (var i = 0; i < n; i++) { var part = DO.substr(i*WK, WK); var dec = parseInt(part, 2); chars += self.JK(dec); } return chars; }; self.KZ = function(el) { while (el.firstChild && el.firstChild.nodeType == 1) { el = el.firstChild; } while (el.parentNode) { if (self.BH.getComputedStyle(el).getPropertyValue('opacity') <= 0.2) { return 1; } if (el == self.BH.document.body) { break; } el = el.parentNode; } return 0; }; self.ZC = function() { var n = 0; if (typeof(self.BH.navigator.mimeTypes) !== 'undefined') { n = self.BH.navigator.mimeTypes.length; } return n; }; self.MC = function() { var str = ''; if (typeof(self.BH.navigator.plugins) !== 'undefined') { var arr = self.BH.navigator.plugins; var pl = []; for(var i = 0; i < arr.length; i++) { pl.push(arr[i]['name']); } str = self.WX(pl.join('|').replace(/\s/g,""), 300); } return str; }; self.CU = function() { var r = 0; if (typeof(self.BH.screenX) !== 'undefined') { r = Math.abs(self.BH.screenX); } return r; }; self.GS = function() { var r = 0; if (typeof(self.BH.screenY) !== 'undefined') { r = Math.abs(self.BH.screenY); } return r; }; self.NN = function() { self.QK = 1; }; self.unNN = function() { self.QK = 0; }; self.HO = function() { var elem = self.BH.document.createElement('canvas'); return (elem.getContext && elem.getContext('2d')) ? 1 : 0; }; self.FY = function() { var r = 1; if (typeof(self.BH.navigator.onLine) !== 'undefined') { r = self.BH.navigator.onLine ? 1 : 0; } return r; }; self.generateBatteryInfo = function() { if(self.BH.navigator.getBattery) { self.BH.navigator.getBattery().then(function(battery) { self.afCharging = +battery.charging; self.afLevel = battery.level * 100; }) } }; self.setCoords = function() { var rect = self.root.getBoundingClientRect(); self.afCoords = parseInt(rect.height) + '|' + parseInt(rect.width) + '|' + parseInt(rect.x) + '|' + parseInt(rect.y); }; self.LG = function(element) { var rect = element.getBoundingClientRect(); var toReturn = { top: rect.top, bottom: rect.bottom, left: rect.left, right: rect.right, height: (rect.height ? rect.height : rect.bottom - rect.top), width: (rect.width ? rect.width : rect.right - rect.left) }; if (self.BH.self !== self.BH.top) { var frame = self.TY(); if (frame) { var iframeRect = frame.getBoundingClientRect(); toReturn.top += iframeRect.top; toReturn.bottom += iframeRect.top; toReturn.left += iframeRect.left; toReturn.right += iframeRect.left; } } return toReturn; }; self.TY = function() { if (self.topIFrame === undefined) { try { for (var w = self.BH, frame = w.frameElement; w.frameElement; w = w.parent) { frame = w.frameElement; } self.topIFrame = frame; } catch(err) { self.topIFrame = null; } } return self.topIFrame; }; self.GA = function(event, element) { if (false == self.QY) { return; } var element = element || self.BH.document.createElement('A'); var event = event || self.BH.document.createEvent('MouseEvent'); var date = new Date(); var AQ = self.QA(event); var TL = self.TR(event); var b = self.LG(element); var HK = self.OB(element); var d = self.BH.document; var tsp = self.KZ(element); self.setCoords(); var CO = ''; for (var i = 1; i <= Math.ceil((self.KX + 1) / 68) * 48; i++) { if ((i % 26 == 0) || ((i % 26 == 6) && (((i % 26) + 5) % 11 == 0))) { continue; } CO += (i == 1 ? String.fromCharCode(98 + (i % 26)) : String.fromCharCode(102)); var LA = ''; if (i > 48) { break; } switch (i) { case 1: LA = self.LC; break; case 2: LA = self.XH(b.bottom); break; case 3: LA = self.SS; break; case 4: LA = self.XH(date.getTime()); break; case 5: LA = self.XH(d.body.clientHeight); break; case 7: LA = self.XH(TL.x); break; case 8: LA = self.XH(TL.y); break; case 9: LA = self.XH(b.left); break; case 10: LA = self.XH(self.YD); break; case 11: LA = self.XH(b.top); break; case 12: LA = self.XH(d.body.clientHeight - TL.y); break; case 13: LA = self.XH(b.width); break; case 14: LA = self.XH(b.height); break; case 15: LA = self.BO; break; case 16: LA = self.XH(event.clientY); break; case 17: LA = self.XH(self.KX); break; case 18: LA = self.XH(element['\x64\x61\x74\x61\x2d\x72\x65\x6C']); break; case 19: LA = self.IH; break; case 20: LA = self.VL; break; case 21: LA = self.NM; break; case 22: LA = self.XH(self.VS); break; case 23: LA = self.XH(AQ.x); break; case 24: LA = self.XH(AQ.y); break; case 25: LA = self.XH(HK.x); break; case 27: LA = self.XH(HK.y); break; case 28: LA = self.JK(self.FS()); break; case 29: LA = self.NS(self.afCoords); break; case 30: LA = self.XH(self.BH.screen.width); break; case 31: LA = self.XH(self.BH.screen.height); break; case 33: LA = self.XH(self.TE); break; case 34: LA = self.XH(tsp); break; case 35: LA = self.NS(self.BH.navigator.userAgent); break; case 36: LA = self.PW; break; case 37: LA = self.AO; break; case 38: LA = self.NS(self.BH.navigator.platform); break; case 39: LA = self.NS(-date.getTimezoneOffset()); break; case 40: LA = self.NS(self.afCharging+'|'+self.afLevel); break; case 41: LA = self.XH(self.BH.screen.availWidth); break; case 42: LA = self.XH(self.BH.screen.availHeight); break; case 43: LA = self.XH(self.CU()); break; case 44: LA = self.XH(self.GS()); break; case 45: LA = self.XH(self.QKFlag); break; case 46: LA = self.XH(self.getMaxTouchPoints()); break; case 47: LA = self.XH(self.HO()); break; case 48: LA = self.XH(self.FY()); break; } CO += LA; } return encodeURIComponent(CO); }; self.SL = function(event, element) { if (!event) var event = self.BH.event; if (!event.target) { event.target = event.srcElement; } var hash = element['data-hash'] || element.getAttribute('data-hash'); if (typeof(hash) == 'undefined' || element.tagName != 'A') { return; } element[self.hrefAttr] = self.GN(hash, event, element); }; self.HI = function(event) { if (!event) var event = self.BH.event; if (!event.target) { event.target = event.srcElement; } self.QY = true; var element = event.target; if (element.tagName != 'A') { var element = self.GO(element); if (null == element) { return; } } if (!element.hasAttribute('data-hash')) { return; } var v = 0; if (parseInt(element['\x64\x61\x74\x61\x2d\x72\x65\x6C'])) { v = parseInt(element['\x64\x61\x74\x61\x2d\x72\x65\x6C']); } if (!((v >> 1) & (16 >> 1))) { element['\x64\x61\x74\x61\x2d\x72\x65\x6C'] = v + 16; } self.SL(event, element); }; self.BN = function(event) { if (!event) var event = self.BH.event; if (!event.target) { event.target = event.srcElement; } self.QY = true; var element = event.target; if (element.tagName != 'A') { var element = self.GO(element); if (null == element) { return; } } if (!element.hasAttribute('data-hash')) { return; } self.SL(event, element); self.BH.setTimeout(function() { self.QY = false; self.SL(event, element); }, 100); }; self.LU = function(event) { if (!event) var event = self.BH.event; if (!event.target) { event.target = event.srcElement; } self.QY = true; var element = event.target; if (element.tagName != 'A') { var element = self.GO(element); if (null == element) { return; } } if (!element.hasAttribute('data-hash')) { return; } var v = 0; if (parseInt(element['\x64\x61\x74\x61\x2d\x72\x65\x6C'])) { v = parseInt(element['\x64\x61\x74\x61\x2d\x72\x65\x6C']); } if (v % 2 != 1) { element['\x64\x61\x74\x61\x2d\x72\x65\x6C'] = v + 1; } self.SL(event, element); }; self.KO = function(event) { if (!event) var event = self.BH.event; if (!event.target) { event.target = event.srcElement; } self.YD = 0; self.BH.clearInterval(self.IM); self.IM = self.BH.setInterval(function() { self.YD++; }, 100); }; self.PC = function(event) { if (!event) var event = self.BH.event; if (!event.target) { event.target = event.srcElement; } self.QY = true; var element = event.target; if (element.tagName != 'A') { var element = self.GO(element); if (null == element) { return; } } if (!element.hasAttribute('data-hash')) { return; } var v = 0; if (parseInt(element['\x64\x61\x74\x61\x2d\x72\x65\x6C'])) { v = parseInt(element['\x64\x61\x74\x61\x2d\x72\x65\x6C']); } if ((v >> 1) % 2 != 1) { element['\x64\x61\x74\x61\x2d\x72\x65\x6C'] = v + 2; } self.SL(event, element); }; self.CJ = function(event) { self.QY = true; var element = event.target; if (element.tagName != 'A') { var element = self.GO(element); if (null == element) { return; } } if (!element.hasAttribute('data-hash')) { return; } var v = 0; if (parseInt(element['\x64\x61\x74\x61\x2d\x72\x65\x6C'])) { v = parseInt(element['\x64\x61\x74\x61\x2d\x72\x65\x6C']); } if (!((v >> 1) & (4 >> 1))) { element['\x64\x61\x74\x61\x2d\x72\x65\x6C'] = v + 4; } self.SL(event, element); }; self.WQ = function(event) { if (!event) var event = self.BH.event; if (!event.target) { event.target = event.srcElement; } self.QY = true; var element = event.target; if (element.tagName != 'A') { var element = self.GO(element); if (null == element) { return; } } if (!element.hasAttribute('data-hash')) { return; } var v = 0; if (parseInt(element['\x64\x61\x74\x61\x2d\x72\x65\x6C'])) { v = parseInt(element['\x64\x61\x74\x61\x2d\x72\x65\x6C']); } if (!((v >> 1) & (8 >> 1))) { element['\x64\x61\x74\x61\x2d\x72\x65\x6C'] = v + 8; } self.SL(event, element); }; self.MS = function() { if (!self.TE) { self.TE = (new Date()).getTime(); } }; self.GZ = function(element) { if (typeof element == 'undefined') { element = self.root; } self.addEvent(element, "mousedown", self.HI); self.addEvent(element, "mouseup", self.BN); self.addEvent(element, "mouseover", self.LU); self.addEvent(element, "mousemove", self.PC); self.addEvent(element, "touchstart", self.CJ); self.addEvent(element, "touchend", self.WQ); self.addEvent(self.BH.document, "scroll", self.KO); self.addEvent(self.BH, "focus", self.NN); self.addEvent(self.BH, "blur", self.unNN); var regex = /\/\/img.*\/[\d]+\/([\d]+).*\.(jpg|gif)/; var regexNewFormat = /\/\/s-img.*\/([\d]+)\/.*\.(jpg|gif)/; var images = self.root.getElementsByTagName('IMG'); for (var i = 0; i < images.length; i++) { var res = regex.exec(images[i].src); if (!res) { res = regexNewFormat.exec(images[i].src); } self.addEvent(images[i], "load", self.MS); } };}; this['MarketGidCAntifraudBlock605'].call(this['MarketGidInfC605'], this['MarketGidInfC605']); this['MarketGidInfC605']['funcBlocks']['Antifraud'] = 'MarketGidCAntifraudBlock605'; MarketGidCDiscountBlock605 = function(self){ this.HL.push("XT"); this.PN = function(event) { self.helpIE(this); var pricesold = this.getElementsByClassName('mcpriceold312'); var prices = this.getElementsByClassName('mcprice312'); var discounts = this.getElementsByClassName('mcdiscount312'); if (pricesold.length > 0) { pricesold[0].style.display = 'none'; prices.length > 1 ? prices[1].style.display = 'none' : null; discounts.length > 0 ? discounts[0].style.display = 'inline' : null; } }; this.WZ = function(event) { self.helpIE(this); var discounts = this.getElementsByClassName('mcdiscount312'); var prices = this.getElementsByClassName('mcprice312'); var pricesold = this.getElementsByClassName('mcpriceold312'); if (pricesold.length > 0) { discounts.length > 0 ? discounts[0].style.display = 'none' : null; prices.length > 1 ? prices[1].style.display = 'inline' : null; pricesold[0].style.display = 'inline'; } }; this.XT = function() { if (this.root) { this.helpIE(this.root); var teasers = this.root.getElementsByClassName('mcteaser312'); } for (var MG_t in teasers) { teasers[MG_t].onmouseout = this.WZ; teasers[MG_t].onmouseover = this.PN; } }; this.helpIE = function(el) { if (el.getElementsByClassName == undefined) { el.getElementsByClassName = function(cl) { var retnode = []; var myclass = new RegExp('\\b'+cl+'\\b'); var elem = this.getElementsByTagName('*'); for (var i = 0; i < elem.length; i++) { var classes = elem[i].className; if (myclass.test(classes)) retnode.push(elem[i]); } return retnode; }; } }; }; this['MarketGidCDiscountBlock605'].call(this['MarketGidInfC605'], this['MarketGidInfC605']); this['MarketGidInfC605']['funcBlocks']['Discount'] = 'MarketGidCDiscountBlock605'; MarketGidCCountersBlock605 = function(self){ this.HL.push("BR"); this.BR = function() { var partnerId = ''; if (self.id != 605) { var child = self.childWidgetsData[self.id]; partnerId = child.hasNewsWidget ? child.newsWidgetIdPartner : null; } }; }; this['MarketGidCCountersBlock605'].call(this['MarketGidInfC605'], this['MarketGidInfC605']); this['MarketGidInfC605']['funcBlocks']['Counters'] = 'MarketGidCCountersBlock605'; this['MarketGidCAdvertLinkBlock605'] = function(self) { self.ME.push("refreshAdvertLink"); self.HL.push("initAdvertPopup"); self.getAdvertLinkValue = function() { return parseInt('1'); }; self.removeElements = function(elements) { for (var i = 0; i < elements.length; i++) { elements[i].parentNode.removeChild(elements[i]); } }; self.refreshAdvertLink = function() { var adLink = self.getAdvertLinkValue(); if (adLink) { try { var adLinkBlock = self.LFsAdLinkBlocks[self.YJ].replace(/%id/g, self.id); var widgetTitle = "" || ""; adLinkBlock = adLinkBlock.replace("%WIDGET_TITLE%", widgetTitle); adLinkBlock = adLinkBlock.replace(/\((\'|\")?\/\//g, '($1' + self.webProtocol + '//'); adLinkBlock = adLinkBlock.replace('src="//', 'src="' + self.webProtocol + '//'); adLinkBlock = adLinkBlock.replace('href="//', 'href="' + self.webProtocol + '//'); var utm = ''; if (utm == '') { utm = self.LFsUtm[self.YJ]; } self.GD = adLinkBlock.replace(/%utm/, utm); if (adLink === 1) { return; } var container = document.createElement('div'); container.innerHTML = self.GD; if (adLink === 2) { self.removeElements(container.getElementsByClassName('mg_addad' + self.id)); } if (adLink === 3) { self.removeElements(container.getElementsByClassName('mghead')); } self.GD = container.innerHTML; } catch (e) { } } else { self.GD = ''; } }; self.parseAdvertLink = function(template) { var marker = '<!--advertPrefix-->'; var adLink = self.getAdvertLinkValue(); var isMarkerInTheSecondPart = template.indexOf(marker) > (template.length / 2); if (isMarkerInTheSecondPart) { self.fixGetElementsByClassNameHandler(self.root); self.removeElements(self.root.getElementsByClassName('mg_addad' + self.id)); } if (isMarkerInTheSecondPart || self.HZ == 0) { if (template.indexOf(marker) >= 0) { template = template.replace(marker, this.GD); } else { template = self.GD + template; } } return template; }; self.initAdvertPopup = function () { if (self.BH.top != self.BH.self) { return; } if ('' == 'banner') { return; } if ('' == 'exit-pop-up' || parseInt('0') > 0) { return; } if (['tablet', 'desktop'].indexOf(self.deviceType) == -1) { return; } if (typeof self.BH._mgDisableAdvertPopup != 'undefined') { return; } if (typeof MarketGidCConstructorBlock605 == 'function') { return; } var adEl = self.root.querySelector('.mg_addad' + self.id); if (adEl) { adEl.addEventListener("click", self.showAdvertPopup); } }; self.showAdvertPopup = function (event) { var srcEl = self.KI(event.target, '[data-advert-url]'); if (!srcEl) { return null; } event.preventDefault(); var root = (self.realRoot != undefined ? self.realRoot : self.root).parentNode; var container = root.querySelector('._mgAdvertPopupC605'); var innerEl = root.querySelector('._mgPopupInner'); var scrollTo = function(element, to, duration) { if (duration <= 0) return; var difference = to - element.scrollTop; var perTick = difference / duration * 10; setTimeout(function() { element.scrollTop = element.scrollTop + perTick; if (element.scrollTop === to) return; scrollTo(element, to, duration - 10); }, 10); }; if (!container) { var template = '<style> ._mgAdvertPopupC605 { position: fixed; width: 100%; height: 100%; top: 0px; left: 0px; font-family: "PTSans", Arial, sans-serif; font-size: 16px; color: #696969; line-height: 1.3; z-index: 999; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; } ._mgAdvertPopupC605 iframe { width: 100%; height: 377px; } ._mgAdvertPopupC605 ._mgPopupShadow { position: absolute; top: 0px; left: 0px; width: 100%; height: 100%; background-color: #000; opacity: 0.4; -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=40)"; z-index: 1; } ._mgAdvertPopupC605 ._mgPopupInner { position: relative; top: 50%; margin-left: -375px; left: 50%; padding: 36px; width: 750px; background-color: #f8f8f8; z-index: 2; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; } ._mgAdvertPopupC605 ._mgPopupInner.fixPop { position: absolute!important; top: 30px!important; margin-top: 0!important; } ._mgAdvertPopupC605 ._mgClosePopup { position: absolute; overflow: hidden; top: 5px; right: 5px; height: 21px; width: 21px; text-indent: -9999px; background: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAALAgMAAADUwp+1AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAACVBMVEVmZmZmZmb///+E1CFqAAAAAXRSTlMAQObYZgAAAAFiS0dEAmYLfGQAAAAJcEhZcwAACxIAAAsSAdLdfvwAAAAlSURBVAjXY3BgYGEQAEIWBgcGRkYGBgYXIBaA0CA+SBwkD1QHACp2Ae2BHO8IAAAAAElFTkSuQmCC\') no-repeat center center; background-color: transparent; } ._mgAdvertPopupC605 ._mgClosePopup:hover { background-color: #dfdfdf; }</style><div class="_mgAdvertPopupC605"> <div class="_mgPopupShadow"></div> <div class="_mgPopupInner"> <a href="#" class="_mgClosePopup" title="Close"></a> <iframe frameborder="0"></iframe> </div></div>'; var elements = self.htmlToElements(template); for (var i = 0; i < elements.length; i++) { root.appendChild(elements[i]); } container = root.querySelector('._mgAdvertPopupC605'); if (!container) { return false; } innerEl = container.querySelector('._mgPopupInner'); var shadowEl = container.querySelector('._mgPopupShadow'); innerEl.style.marginTop = -(innerEl.clientHeight / 2) + 'px'; shadowEl.addEventListener('click', function(event) { if (null == self.KI(event.target, '._mgPopupInner')) { container.setAttribute('style', 'display: none'); } }); var closeButton = container.querySelector('._mgClosePopup'); if (closeButton) { closeButton.addEventListener('click', function (event) { event.preventDefault(); container.setAttribute('style', 'display: none'); }) } var iframe = container.querySelector('iframe'); iframe.setAttribute('src', srcEl.getAttribute('data-advert-url')); var eventMethod = self.BH.addEventListener ? "addEventListener" : "attachEvent"; var eventer = self.BH[eventMethod]; var messageEvent = eventMethod == "attachEvent" ? "onmessage" : "message"; eventer(messageEvent,function(e) { var key = e.message ? "message" : "data"; var data = JSON.parse(e[key]); if (typeof data.target == 'undefined' || data.target != 'correct-popup-height') { return true; } iframe.style.height = data.height + 'px'; if (data.safariIPad) { if (data.keyboard) { scrollTo(self.BH.document.body, 0, 500); innerEl.classList.add('fixPop'); } else { innerEl.classList.remove('fixPop'); } } innerEl.style.marginTop = -(innerEl.clientHeight / 2) + 'px'; }, false); } container.setAttribute('style', 'display: block'); if (innerEl.className.indexOf('fixPop') >= 0) { scrollTo(self.BH.document.body, 0, 500); } };}; this['MarketGidCAdvertLinkBlock605'].call(this['MarketGidInfC605'], this['MarketGidInfC605']); this['MarketGidInfC605']['funcBlocks']['AdvertLink'] = 'MarketGidCAdvertLinkBlock605'; this['MarketGidCRejectBlock605'] = function(self) { self.isInsertedRejectStyles = false; self['MarketGidReject'] = function () { var baseUrl = self.subnetDashboardDomains[self.getSubnetByMirror('marketgid')]; self.fixGetElementsByClassNameHandler(self.root); var mglines = self.root.getElementsByClassName('mgline'); for (var i = 0; i < mglines.length; i++) { (function(mgline) { if (mgline.className.indexOf('dsp') >= 0) { return; } self.fixGetElementsByClassNameHandler(mgline); var imgList = mgline.getElementsByClassName('mcimg'); var img = false; for (var j = 0; j < imgList.length; j++) { if (imgList[j].tagName == "DIV") { img = imgList[j]; break; } } if (!img) { return; } self.fixGetElementsByClassNameHandler(img); var el = img.getElementsByClassName('close-informer'); var matchId = mgline.className.match(/teaser-([0-9]+)/); if (null == matchId) { return; } var matchType = mgline.className.match(/type-(w|e|i)/); if (null == matchType || matchType[1] == 'i') { return; } if (el.length == 0) { var url = baseUrl; url += '/publisher/blocked'; var a = self.BH.document.createElement('a'); var imgStyles = self.BH.getComputedStyle(img); a.className = "close-informer"; a.href = url + '/teaser/' + matchId[1] + '/widget/' + (matchType[1] == 'w' ? '18742/type/goods' : '/type/news'); a.target = '_blank'; a.rel = "nofollow"; a.style.top = (parseInt(imgStyles.borderTopWidth) + 3) + 'px'; a.style.right = (parseInt(imgStyles.borderRightWidth) +3) + 'px'; img.style.position = "relative"; img.appendChild(a); } })(mglines[i]); } }; self.initRejectStyles = function() { if (self.isInsertedRejectStyles) { return; } var rejectStyles = '\ div.mcimg a.close-informer {\ width: 14px;\ height: 14px;\ background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NDkxMSwgMjAxMy8xMC8yOS0xMTo0NzoxNiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo5NzI0ODBDMzY3ODcxMUU1OEM4RUU2RUJCOUREODIyQiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo5NzI0ODBDNDY3ODcxMUU1OEM4RUU2RUJCOUREODIyQiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjk3MjQ4MEMxNjc4NzExRTU4QzhFRTZFQkI5REQ4MjJCIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjk3MjQ4MEMyNjc4NzExRTU4QzhFRTZFQkI5REQ4MjJCIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+uNcpEQAAAHxJREFUeNqckgEKwCAIRe3fYjfKc2zX6hydaLRbbDnGkLDIPggl/5lKIcbIRJRqbDSnUmOHE6LPm+CEfhj6lnN+o5WVh1VOm6xColCXc/cgLWYev9gaejnQojCab5RDzyDt6RantqoBaz5zq54ZywJ3CXjIwQGd8skfAQYALdQqftYulocAAAAASUVORK5CYIJ0ZW50Ij4NCiA8ZGl2IGNsYXNzPSJjb250ZW50LWNvbnRhaW5lciI+PGZpZWxkc2V0Pg0KICA8aDI+NTAyIC0gV2ViIHNlcnZlciByZWNlaXZlZCBhbiBpbnZhbGlkIHJlc3BvbnNlIHdoaWxlIGFjdGluZyBhcyBhIGdhdGV3YXkgb3IgcHJveHkgc2VydmVyLjwvaDI+DQogIDxoMz5UaGVyZSBpcyBhIHByb2JsZW0gd2l0aCB0aGUgcGFnZSB5b3UgYXJlIGxvb2tpbmcgZm9yLCBhbmQgaXQgY2Fubm90IGJlIGRpc3BsYXllZC4gV2hlbiB0aGUgV2ViIHNlcnZlciAod2hpbGUgYWN0aW5nIGFzIGEgZ2F0ZXdheSBvciBwcm94eSkgY29udGFjdGVkIHRoZSB1cHN0cmVhbSBjb250ZW50IHNlcnZlciwgaXQgcmVjZWl2ZWQgYW4gaW52YWxpZCByZXNwb25zZSBmcm9tIHRoZSBjb250ZW50IHNlcnZlci48L2gzPg0KIDwvZmllbGRzZXQ+PC9kaXY+DQo8L2Rpdj4NCjwvYm9keT4NCjwvaHRtbD4NCg==");\ display: block;\ opacity: 0;\ position: absolute;\ right: 3px;\ top: 3px;\ z-index: 1;\ cursor: pointer;\ }\ div.mgline:hover a.close-informer {\ opacity: 0.7;\ -moz-transition: all 0.3s ease-out;\ -o-transition: all 0.3s ease-out;\ -webkit-transition: all 0.3s ease-out;\ -ms-transition: all 0.3s ease-out;\ transition: all 0.3s ease-out;\ }\ div.mgline a.close-informer:hover {\ opacity: 1;\ -moz-transition: all 0.3s ease-out;\ -o-transition: all 0.3s ease-out;\ -webkit-transition: all 0.3s ease-out;\ -ms-transition: all 0.3s ease-out;\ transition: all 0.3s ease-out;\ }\ div.mcimg {\ position: relative;\ display: inline-block\ }\ div.image-with-price {\ position: relative;\ }\ .mgline .image-container {\ width: auto;\ margin: 0 auto;\ position: relative;\ }'; self.styles += rejectStyles; self.isInsertedRejectStyles = true; }; self.ME.push('initRejectStyles');}; this['MarketGidCRejectBlock605'].call(this['MarketGidInfC605'], this['MarketGidInfC605']); this['MarketGidInfC605']['funcBlocks']['Reject'] = 'MarketGidCRejectBlock605'; this['MarketGidCExternalCountersBlock605'] = function(self){ self.YC; self.HL.push("HJ"); var MR = function (event) { if (self.YC && event.target.className.indexOf('Button') === -1) { return; } if (!event) { event = self.BH.event; } if (!event.target) { event.target = event.srcElement; } var element = event.target; if (element.tagName != 'A') { element = self.GO(element); if (null == element) { return; } } if (!element.hasAttribute('data-hash')) { return; } var hash = element.getAttribute('data-hash'); if (!self.IN[hash]) { return; } if (!Array.isArray(self.IN[hash]['clicktrackers'])) { return; } var clicktrackers = self.IN[hash]['clicktrackers']; if (!clicktrackers.length) { return; } for (var i = 0; i < clicktrackers.length; i++) { var img = self.BH.document.createElement('IMG'); img.src = clicktrackers[i]; } }; self.HJ = function(element) { if (typeof element == 'undefined') { element = self.root; } self.addEvent(element, 'click', MR); };}; this['MarketGidCExternalCountersBlock605'].call(this['MarketGidInfC605'], this['MarketGidInfC605']); this['MarketGidInfC605']['funcBlocks']['ExternalCounters'] = 'MarketGidCExternalCountersBlock605'; MarketGidCCriteoBlock605 = function(self){ self.BH.LoadCriteoAllPlaces = function (params) { self.criteoNurl = params.l; var s = self.BH.document.createElement('script'); self.criteoParams = params.pos; s.type = 'text/javascript'; s.async = 'async'; s.src = 'https://static.criteo.net/js/ld/publishertag.js'; var h = self.BH.document.getElementsByTagName('script')[0]; h.parentNode.insertBefore(s, h); self.BH.Criteo = self.BH.Criteo || {}; self.BH.Criteo.events = self.BH.Criteo.events || []; self.BH.Criteo.events.push(function() { var adUnit = { "placements": [ { "slotid": self.root.id, "zoneid": params.z, "nativeCallback": function(assets) { self.BH.ProcessCriteo(assets); } }, ] }; self.BH.Criteo.Passback.RequestBids(adUnit, 1500); }); self.BH.Criteo.events.push(function() { self.BH.Criteo.Passback.RenderAd({ adUnit: self.root.id, passback: function(adunit){} }); }); }; self.BH.ProcessCriteo = function (response) { self.HZ = 0; self.root.innerHTML = ''; self.iteration = 1; self.PY = []; var hashes = []; var data = self.json; var advDomain = ""; if ("advertiser" in response && "domain" in response.advertiser) { advDomain = response.advertiser.domain; } var host = 1 === 1 ? 'marketgid' : 'mgid'; var placements = response.products.length; for (var k = 0; k < placements; k++) { self.criteoPlacement = k; if (typeof data[k] === 'undefined'){ continue; } data[self.criteoPlacement][0] = advDomain; data[self.criteoPlacement][1] = k+1; data[self.criteoPlacement][3] = response.products[k].title; data[self.criteoPlacement][4] = response.products[k].description; data[self.criteoPlacement][7] = response.products[k].price; data[self.criteoPlacement][8] = ""; data[self.criteoPlacement][10].i = self.webProtocol + "//imggprx." + host + ".com/i/resize?img=" + encodeURIComponent(response.products[k].image.url) + "&size=9"; data[self.criteoPlacement][10].l = self.criteoParams[k]+"&u="+self.NR(response.products[k].click_url); data[self.criteoPlacement][10].adc = []; hashes.push(self.teaserHashes[data[k].id]); } self.MarketGidLoadNews(data); for (var k = 0; k < placements; k++) { self.criteoPlacement = k; if (data[k] == undefined) { continue; } if (response.hasOwnProperty('privacy') && response.privacy.hasOwnProperty('optout_click_url') && response.privacy.hasOwnProperty('optout_image_url')) { var imgElement = self.root.getElementsByClassName('mgline')[self.criteoPlacement].getElementsByClassName('mcimg')[0]; var privacyDiv = self.BH.document.createElement('DIV'); privacyDiv.style.position = 'absolute'; privacyDiv.style.zIndex = '100'; privacyDiv.style.left = '90%'; privacyDiv.style.top = '0'; var privacyHref = self.BH.document.createElement('A'); privacyHref.setAttribute('href', response.privacy.optout_click_url); privacyHref.setAttribute('target', "_blank"); var privacyImg = self.BH.document.createElement('IMG'); privacyImg.setAttribute('src', response.privacy.optout_image_url); privacyHref.appendChild(privacyImg); privacyDiv.appendChild(privacyHref); imgElement.appendChild(privacyDiv); if (response.hasOwnProperty('impression_pixels')) { for (var i in response.impression_pixels) { if (response.impression_pixels[i].hasOwnProperty('url')) { var im = self.BH.document.createElement('IMG'); im.src = response.impression_pixels[i].url; self.BH.document.body.appendChild(im) } } } } } var n = self.BH.document.createElement('IMG'); n.src = self.criteoNurl + "&ads=" + hashes.join(','); self.BH.document.body.appendChild(n); };}; this['MarketGidCCriteoBlock605'].call(this['MarketGidInfC605'], this['MarketGidInfC605']); this['MarketGidInfC605']['funcBlocks']['Criteo'] = 'MarketGidCCriteoBlock605'; MarketGidCSendDimensionsBlock605 = function(self){ self.blankImage = "data:image/gif;base64,R0lGODlhWgBaAPAAAAAAAAAAACH5BAEAAAAALAAAAABaAFoAAAJlhI+py+0Po5y02ouz3rz7D4biSJbmiabqyrbuC8fyTNf2jef6zvf+DwwKh8Si8YhMKpfMpvMJjUqn1Kr1is1qt9yu9wsOi8fksvmMTqvX7Lb7DY/L5/S6/Y7P6/f8vv8PGCh4VgAAOw=="; self.precalcRect = {}; self.updatePrecalcRect = function(callback) { self.OG = "goods"; self.YJ = '0'; self.fakeMode = true; self.realRoot = self.root; var cnt = self.BH.document.createElement('div'); var newRoot = self.BH.document.createElement('div'); newRoot.id = self.root.id; self.root.id += "_"; cnt.appendChild(newRoot); self.root.appendChild(cnt); self.root = newRoot; self.realRoot.style.height = "0px"; self.realRoot.style.overflow = "hidden"; var countNews = 3; var lorem = "Lorem ipsum dolor sit amet Lorem ipsum dolor sit amet"; var data = []; for (var i = 1; i <= countNews; i++) { data.push(['', i,'', lorem, lorem, '', '', '', '', '', {i: self.blankImage}]); } self.MarketGidLoadNews(data); setTimeout(function () { var h = self.IG(); self.fixGetElementsByClassNameHandler(self.root); var widgetRect = self.root.getBoundingClientRect(); if (self.root.getElementsByClassName("mgbox")[0]) { widgetRect = self.root.getElementsByClassName("mgbox")[0].getBoundingClientRect(); } self.precalcRect.width = parseInt(widgetRect.width ? widgetRect.width : widgetRect.right - widgetRect.left); self.precalcRect.height = parseInt(widgetRect.height ? widgetRect.height : widgetRect.bottom - widgetRect.top); self.precalcRect.top = widgetRect.top; self.precalcRect.bottom = widgetRect.bottom; self.requestParams.w = "w=" + self.precalcRect.width; self.requestParams.h = "h=" + self.precalcRect.height; var cols = 0; var elx = self.root.getElementsByClassName('mgline'); var bannerPlacement = ''.split(',').map(Number) || []; for (i = 0; i < elx.length; i++) { var elementCount = i + 1; var rect = elx[i].getBoundingClientRect(); if (bannerPlacement.indexOf(elementCount) !== -1) { var height = parseInt(rect.height ? rect.height : rect.bottom - rect.top); var width = parseInt(rect.width ? rect.width : rect.right - rect.left); self.requestParams['p' + elementCount + '_w'] = 'p' + elementCount + '_w=' + width; self.requestParams['p' + elementCount + '_h'] = 'p' + elementCount + '_h=' + height; } if (typeof prepTop != "undefined" && prepTop < rect.top && cols === 0) { cols = i;} var prepTop = rect.top; } if (cols == 0) { cols = elx.length; } self.requestParams.cols = "cols=" + cols; self.fakeMode = false; self.root = self.realRoot; self.root.removeChild(cnt); self.root.id = self.root.id.substr(0, self.root.id.length - 1); self.root.style.height = "auto"; self.root.style.overflow = "visible"; self.OG = ""; self.YJ = ""; self.HZ = 0; self.template = ""; self.iteration = 1; self.PY = {}; if (typeof callback == "function") { self.widgetPreload = true; callback(); } }.bind(callback), 0); };}; this['MarketGidCSendDimensionsBlock605'].call(this['MarketGidInfC605'], this['MarketGidInfC605']); this['MarketGidInfC605']['funcBlocks']['SendDimensions'] = 'MarketGidCSendDimensionsBlock605'; MarketGidCMonitorBlock605 = function(self){ this.HL.push("monitorInit"); this.shownBlocks = {}; this.monitorTimeout = null; this.isFirstByType = {}; this.isFirstByCid = {}; this.monitorInit = function() { var regex = /\/\/img.*\/[\d]+\/([\d]+).*\.(jpg|gif)/; var regexNewFormat = /\/\/s-img.*\/([\d]+)\/.*\.(jpg|gif)/; if (typeof (IntersectionObserver) === 'function' && self.servicerData.cv === 3) { var threshold = 0.9; var thresholdMs = 1000; var observedCollected = 0; var observeCount = 0; var intersectingObjs = []; var intersectTimeOut = null; var setIntersectingTime = function () { var shown = 0; for (var i = 0; i < intersectingObjs.length; i++) { if (!!intersectingObjs[i]) { if (intersectingObjs[i].dataset.shown) { shown++ } else { if (intersectingObjs[i].dataset.observeStart > 0) { var observeTime = parseFloat(intersectingObjs[i].dataset.observeTime) + ((new Date()).getTime() - intersectingObjs[i].dataset.observeStart); if (observeTime > thresholdMs) { self.intersectionObserver.unobserve(intersectingObjs[i]); self.intersectionObserver.observe(intersectingObjs[i]); } } } } } if (shown < observedCollected) { setTimeout(arguments.callee, 100) } }; if (!self.intersectionObserver) { var callback = function(entries) { if (!intersectTimeOut) { intersectTimeOut = setTimeout(setIntersectingTime, 100); } var newBlocks = {}; var newBlocksCount = 0; for (var i = 0; i < entries.length; i++) { var entry = entries[i]; if (!entry.target.dataset.i || entry.target.dataset.shown) { continue; } if (entry.target.width + entry.target.height == 0) { self.intersectionObserver.unobserve(entry.target); (function() { var img = entry.target; setTimeout(function() { self.intersectionObserver.observe(img); }, 100); } )(); continue; } if (entry.intersectionRatio >= threshold) { if (entry.target.dataset.observeStart == 0) { entry.target.dataset.observeStart = (new Date()).getTime() } else { observeTime = (new Date()).getTime() - entry.target.dataset.observeStart; entry.target.dataset.observeTime = parseFloat(entry.target.dataset.observeTime) + observeTime; } } else { entry.target.dataset.observeTime = 0; entry.target.dataset.observeStart = 0; } if (entry.target.dataset.observeTime >= thresholdMs) { entry.target.dataset.shown = 1; self.intersectionObserver.unobserve(entry.target); var teaserBlock = self.getParentTeaserBlock(entry.target); if (teaserBlock) { var teaserDims = self.utils.getRect(teaserBlock, true); newBlocks[entry.target.dataset.i] = { width: entry.target.width, height: entry.target.height, atf: teaserDims.top < self.utils.getViewportSize().height, align: self.getTeaserAlign(teaserDims), desc: self.isTeaserElementVisible(teaserBlock, 'mcdesc'), price: self.isTeaserElementVisible(teaserBlock, 'mcprice'), domain: self.isTeaserElementVisible(teaserBlock, 'mcdomain') }; } else { newBlocks[entry.target.dataset.i] = { width: Math.round(entry.target.width), height: Math.round(entry.target.height), desc: false, price: false, domain: false }; } newBlocksCount++; } } if (newBlocksCount) { self.prepareCappingData(newBlocks, self.servicerData.cv); } }; self.intersectionObserver = new IntersectionObserver(callback, {threshold: [0,threshold,1]}); } var collectObjs = []; var collectTimeout = null; var collectCallback = function() { collectTimeout = null; for (var obj = collectObjs.pop(); !!obj; obj = collectObjs.pop()) { self.intersectionObserver.observe(obj); } }; var intersectionObserverCollect = function(obj) { collectObjs.push(obj); intersectingObjs.push(obj); observedCollected++; if (collectTimeout) { clearTimeout(collectTimeout) } if (observedCollected < observeCount) { console.log("collectTimeout"); collectTimeout = setTimeout(collectCallback, 100); } else { console.log("collectCallback"); collectCallback() } }; (function() { var images = self.root.getElementsByTagName('IMG'); if (images.length) { for (var i = 0; i < images.length; i++) { if (!images[i].dataset.observing) { var res = regex.exec(images[i].src); if (!res) { res = regexNewFormat.exec(images[i].src); } if (!res && images[i].dataset.i) { res = []; res[1] = images[i].dataset.i; } if (res && res[1]) { images[i].dataset.observeTime = 0; images[i].dataset.observeStart = 0; images[i].dataset.observing = "yes"; if (!images[i].dataset.i) { images[i].dataset.i = res[1] } images[i].addEventListener("load", function() { intersectionObserverCollect(this); }); images[i].addEventListener("error", function() { intersectionObserverCollect(this); }); observeCount++; } else { images[i].dataset.observing = "no"; } } } } }()) } else { if (!this.monitorTimeout) { (function () { var newBlocks = {}; var viewportSize = self.utils.getViewportSize(); var images = self.root.getElementsByTagName('IMG'); for (var i = 0; i < images.length; i++) { if (self.isElementInViewport(images[i])) { var res = regex.exec(images[i].src); if (!res) { res = regexNewFormat.exec(images[i].src); } if (!res) { if (images[i].dataset.i) { res = []; res[1] = images[i].dataset.i; } } if (res && res[1] && !self.shownBlocks[res[1]]) { var teaserBlock = self.getParentTeaserBlock(images[i]); var imageRect = self.utils.getRect(images[i], true); if (teaserBlock) { var teaserDims = self.utils.getRect(teaserBlock, true); newBlocks[res[1]] = { width: Math.round(imageRect.width), height: Math.round(imageRect.height), atf: teaserDims.top < viewportSize.height, align: self.getTeaserAlign(teaserDims), desc: self.isTeaserElementVisible(teaserBlock, 'mcdesc'), price: self.isTeaserElementVisible(teaserBlock, 'mcprice'), domain: self.isTeaserElementVisible(teaserBlock, 'mcdomain') }; } else { newBlocks[res[1]] = { width: Math.round(imageRect.width), height: Math.round(imageRect.height), desc: false, price: false, domain: false }; } self.shownBlocks[res[1]] = 1; } } } self.prepareCappingData(newBlocks, "2"); self.monitorTimeout = setTimeout(arguments.callee, 1000); })(); } } }; this.prepareCappingData = function(blocks, pv) { var data = []; var counter = []; var multiCappingData = []; var multiCappingCounter = []; for (var i in blocks) { var prefix = blocks[i].width + "|" + blocks[i].height + "|" + ( (blocks[i].desc ? 1 : 0) + (blocks[i].price ? 2 : 0) + (blocks[i].domain ? 4 : 0) + (blocks[i].atf ? 8 : 0) + (blocks[i].align == 'right' ? 16 : 0) + (blocks[i].align == 'left' ? 32 : 0)) + "|"; var showHash = self.teaserHashes[i]; if (showHash && self.IN[showHash]) { var type = self.IN[showHash]['coopType']; if ( self.IN[showHash].ch && self.IN[showHash].ccid && self.IN[showHash].cdomain ) { multiCappingData = self.prepareMultiCappingData(multiCappingData, showHash, prefix, type, pv); multiCappingCounter = multiCappingData['counter']; if (multiCappingCounter[type][self.IN[showHash]['cdomain']] > 20) { self.multiSendCappingData(multiCappingData[type]); multiCappingData[type] = []; multiCappingCounter = []; } } data = self.prepareSingleCappingData(data, showHash, prefix, type, pv); counter = data['counter']; if (counter[type] > 20) { self.sendCappingData(data[type]); data[type] = ""; counter[type] = 0; } var imp = self.IN[showHash]['imp']; for(var k in imp) { self.sendCustomCounter(imp[k]); } } } for (var type in counter) { if (counter[type] > 0) { self.sendCappingData(data[type]); } } for (var type in multiCappingCounter) { if (Object.keys(multiCappingCounter[type]).length > 0) { self.multiSendCappingData(multiCappingData[type]); } } }; this.prepareMultiCappingData = function (multiCappingData, showHash, prefix, type, pv) { var cdomain = self.IN[showHash]['cdomain']; var servicerShowHash = self.IN[showHash]['ch']; var ccid = self.IN[showHash]['ccid']; var query = 'pv='+pv; if (typeof multiCappingData[type] == "undefined") { multiCappingData[type] = []; if (typeof multiCappingData['counter'] == "undefined") { multiCappingData['counter'] = []; } if (typeof multiCappingData['counter'][type] == "undefined") { multiCappingData['counter'][type] = []; } } if (typeof multiCappingData[type][cdomain] == "undefined") { multiCappingData[type][cdomain] = []; multiCappingData['counter'][type][cdomain] = 0; } if (typeof multiCappingData[type][cdomain][ccid] == "undefined") { multiCappingData[type][cdomain][ccid] = ''; } query += '&v=' + prefix + servicerShowHash; if (pv != "0" && !self.isFirstByType[type + ccid] || !self.isFirstByCid[type + ccid]) { query += '&f' + type + "=1"; self.isFirstByType[type + ccid] = 1; self.isFirstByCid[type + ccid] = 1; } multiCappingData[type][cdomain][ccid] += query; multiCappingData['counter'][type][cdomain]++; return multiCappingData; }; this.prepareSingleCappingData = function (data, showHash, prefix, type, pv) { if (typeof data[type] == 'undefined') { data[type] = 'pv='+pv; if (typeof data['counter'] == "undefined") { data['counter'] = []; } } if (typeof data['counter'][type] == "undefined") { data['counter'][type] = 0; } data[type] += "&v=" + prefix + showHash; if (pv != "0" && !self.isFirstByType[type]) { data[type] += '&f' + type + "=1"; self.isFirstByType[type] = 1; } data['counter'][type]++; return data; }; this.multiSendCappingData = function (data) { for (var domain in data) { for (var cid in data[domain]) { var query = data[domain][cid] + '&cid=' + cid; self.sendCappingData(query, domain); } } }; this.sendCappingData = function (dataQuery, domain) { var img = document.createElement('IMG'); var cidPosition = dataQuery.search('&cid='); var ispv2 = dataQuery.search('pv=0&') == -1; if (-1 != cidPosition) { var cid = dataQuery.substr(cidPosition + 5).split('&')[0]; } if (ispv2) { if (typeof self.BH._mgwcapping == 'undefined' || self.BH._mgwcapping.indexOf(self.id.toString()) == -1 || (typeof cid != "undefined" && self.BH._mgwcapping.indexOf(cid.toString()) == -1)) { dataQuery = "f=1&" + dataQuery; } self.BH._mgwcapping = self.BH._mgwcapping || []; if (typeof cid == "undefined") { dataQuery += "&cid=" + self.id.toString(); self.BH._mgwcapping.push(self.id.toString()); } else { self.BH._mgwcapping.push(cid); } } else if (typeof cid == "undefined") { dataQuery += "&cid=" + self.id.toString(); } if (self.servicerData && self.servicerData.h2) { dataQuery += '&h2=' + self.servicerData.h2; } if (self.servicerData && self.servicerData.rid) { dataQuery += '&rid=' + self.servicerData.rid; } if (self.servicerData && self.servicerData.tt) { dataQuery += '&tt=' + self.servicerData.tt; } if (self.servicerData && self.servicerData.ts) { dataQuery += '&ts=' + self.servicerData.ts; } if (self.BH.localStorage) { var mgMuidn = self.BH.localStorage.getItem('mgMuidn'); if (typeof (mgMuidn) == "string" && mgMuidn.length > 0 ) { dataQuery += '&muid=' + mgMuidn; } } var cappingDomain = self.webProtocol + "//"; if (typeof domain !== "undefined") { cappingDomain += domain; } else { cappingDomain += "c.marketgid.com"; } dataQuery += '&' + self.getCbusterParameter(); dataQuery += '&tpl=' + self.templateId; img.src = cappingDomain + "/c?" + dataQuery; }; this.isElementInViewport = function(el) { var rect = self.utils.getRect(el, false); var viewport = self.utils.getViewportSize(); return ( rect.height > 0 && rect.width > 0 && rect.top >= 0 && rect.left >= 0 && rect.bottom <= viewport.height && rect.right <= viewport.width ); }; this.getParentTeaserBlock = function(el) { var current = el; while (current != self.root && current != self.BH) { if (current.className.indexOf("mgline") >= 0) { return current; } else { current = current.parentNode; } } return null; }; this.isTeaserElementVisible = function(el, className) { self.fixGetElementsByClassNameHandler(el); var elements = el.getElementsByClassName(className); if (elements.length > 0) { var dims = elements[0].getBoundingClientRect(); if (dims.right - dims == 0 || dims.bottom - dims.top == 0) { return false; } else { return true; } } else { return false; } }; this.getTeaserAlign = function(teaserDims) { var bodyWidth = self.BH.document.body.scrollWidth; if (teaserDims.right < 0.3 * bodyWidth) { return 'left'; } else if (teaserDims.left >= 0.7 * bodyWidth) { return 'right' } else { return 'center'; } }; this.sendCustomCounter = function (url) { var img = document.createElement('img'); img.src = url; }}; this['MarketGidCMonitorBlock605'].call(this['MarketGidInfC605'], this['MarketGidInfC605']); this['MarketGidInfC605']['funcBlocks']['Monitor'] = 'MarketGidCMonitorBlock605'; MarketGidInfC605.init(); }
